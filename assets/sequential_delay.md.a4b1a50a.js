import{_ as s,c as n,o as a,a as l}from"./app.df94fffd.js";const i=JSON.parse('{"title":"Delay","description":"","frontmatter":{"outline":"deep"},"headers":[{"level":2,"title":"Brief","slug":"brief","link":"#brief","children":[]},{"level":2,"title":"Entity delay","slug":"entity-delay","link":"#entity-delay","children":[{"level":3,"title":"Arch FF of delay","slug":"arch-ff-of-delay","link":"#arch-ff-of-delay","children":[]}]},{"level":2,"title":"Entity delay_reg","slug":"entity-delay-reg","link":"#entity-delay-reg","children":[{"level":3,"title":"Arch BHV of delay_reg","slug":"arch-bhv-of-delay-reg","link":"#arch-bhv-of-delay-reg","children":[]}]},{"level":2,"title":"Entity delay_tb","slug":"entity-delay-tb","link":"#entity-delay-tb","children":[{"level":3,"title":"Arch random_tb of delay_tb","slug":"arch-random-tb-of-delay-tb","link":"#arch-random-tb-of-delay-tb","children":[]}]}],"relativePath":"sequential/delay.md"}'),p={name:"sequential/delay.md"},o=l(`<h1 id="delay" tabindex="-1">Delay <a class="header-anchor" href="#delay" aria-hidden="true">#</a></h1><details class="details custom-block"><summary>Get source code for this page</summary><div style="display:flex;flex-direction:row;flex-wrap:wrap;"><a href="data:text/plain;charset=utf-8,--%20Greg%20Stitt%0A--%20University%20of%20Florida%0A--%0A--%20Entity%3A%20delay%0A--%20Description%3A%20This%20entity%20delays%20an%20input%20by%20a%20specified%20number%20of%20cycles%2C%0A--%20while%20also%20allowing%20stalls%20and%20specific%20output%20values%20on%20reset.%0A--%0A--%20This%20design%20synthesizes%20to%20the%20same%20structure%20as%20the%20delay%20in%20the%0A--%20structural%20architectures%20section.%20See%20the%20delay.pdf%20schematic%20from%20that%0A--%20section%20for%20a%20reference.%0A--%0A%0Alibrary%20ieee%3B%0Ause%20ieee.std_logic_1164.all%3B%0A%0A-------------------------------------------------------------------------------%0A--%20Generic%20Descriptions%0A--%20CYCLES%20%3A%20The%20length%20of%20the%20delay%20in%20cycles%20(required)%0A--%20WIDTH%20%20%3A%20The%20WIDTH%20of%20the%20input%20signal%20(required)%0A--%20RESET_VALUE%20%3A%20An%20initial%20value%20(of%20WIDTH%20bits)%20for%20the%20first%20%22CYCLES%22%20outputs%0A--%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20after%20a%20reset.%20(optional)%0A-------------------------------------------------------------------------------%0A%0A------------------------------------------------------------------------------%0A--%20Port%20Description%0A--%20clk%20%3A%20clock%0A--%20rst%20%3A%20reset%20(active%20high)%0A--%20en%20%3A%20enable%20(active%20high)%2C%20&#39;0&#39;%20stalls%20the%20delay%20pipeline%0A--%20input%20%3A%20The%20input%20to%20be%20delayed%0A--%20output%20%3A%20The%20input%20after%20CYCLES%20cycles%20elapse%20(assuming%20no%20stalls)%0A-------------------------------------------------------------------------------%0A%0Aentity%20delay%20is%0A%20%20%20%20generic(CYCLES%20%3A%20natural%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20WIDTH%20%20%3A%20positive%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20Here%2C%20we%20again%20use%20an%20unconstrained%20vector%20as%20a%20workaround%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20to%20VHDL%201993%20not%20allowing%20the%20use%20of%20generics%20to%20define%20other%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20generics.%20See%20the%20reg_flexible%20entity%20in%20the%20reg.vhd%20example%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20for%20an%20explanation.%0A%20%20%20%20%20%20%20%20%20%20%20%20RESET_VALUE%20%20%20%3A%20std_logic_vector%20%3A%3D%20%22%22)%3B%0A%20%20%20%20port(clk%20%20%20%20%3A%20in%20%20std_logic%3B%0A%0A%20%20%20%20%20%20%20%20%20--%20Note%20that%20just%20like%20we%20can%20have%20default%20values%20for%20generics%2C%20we%0A%20%20%20%20%20%20%20%20%20--%20can%20also%20have%20default%20values%20for%20inputs.%20Here%2C%20I%20use%20a%20default%0A%20%20%20%20%20%20%20%20%20--%20value%20of%20&#39;0&#39;%20for%20reset%20and%20&#39;1&#39;%20for%20enable%20because%20to%20optimize%20timing%0A%20%20%20%20%20%20%20%20%20--%20of%20pipelines%2C%20I%20very%20often%20never%20reset%20the%20delay%2C%20and%20always%20have%0A%20%20%20%20%20%20%20%20%20--%20it%20enabled.%20By%20providing%20default%20values%2C%20it%20saves%20me%20from%20having%0A%20%20%20%20%20%20%20%20%20--%20to%20explicitly%20make%20these%20connections%20in%20a%20port%20map.%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20rst%20%20%20%20%3A%20in%20%20std_logic%20%3A%3D%20&#39;0&#39;%3B%0A%20%20%20%20%20%20%20%20%20en%20%20%20%20%20%3A%20in%20%20std_logic%20%3A%3D%20&#39;1&#39;%3B%0A%20%20%20%20%20%20%20%20%20input%20%20%3A%20in%20%20std_logic_vector(WIDTH-1%20downto%200)%3B%0A%20%20%20%20%20%20%20%20%20output%20%3A%20out%20std_logic_vector(WIDTH-1%20downto%200))%3B%0Aend%20delay%3B%0A%0A%0A--%20Illustrates%20how%20to%20create%20the%20delay%20using%20flip%20flop%20resources.%20Later%20examples%0A--%20will%20illustrate%20implementations%20for%20other%20resource%20types.%0A%0Aarchitecture%20FF%20of%20delay%20is%0A%0A%20%20%20%20--%20FPGA%20synthesis%20tools%20will%20often%20try%20to%20infer%20more%20coarse-grained%0A%20%20%20%20--%20primitives%20for%20shift%20regsiters%20(e.g.%2C%20embedded%20memory).%20In%20many%20cases%2C%0A%20%20%20%20--%20this%20is%20an%20effective%20optimization%2C%20but%20in%20other%20cases%20we%20might%20explicitly%0A%20%20%20%20--%20want%20flip-flops.%20Synthesis%20tools%20usually%20have%20specific%20attributes%20to%0A%20%20%20%20--%20turn%20off%20such%20functionality.%20The%20example%20below%20illustrates%20how%20to%20disable%0A%20%20%20%20--%20shift%20register%20recognition%20in%20Intel%20Quartus.%20Xilinx%20tools%20likely%20have%0A%20%20%20%20--%20similar%20attributes.%0A%20%20%20%20%0A%20%20%20%20--attribute%20altera_attribute%20%20%20%20%20%20%20%3A%20string%3B%0A%20%20%20%20--attribute%20altera_attribute%20of%20FF%20%3A%20architecture%20is%20%22-name%20AUTO_SHIFT_REGISTER_RECOGNITION%20OFF%22%3B%20%20%20%20%0A%20%20%20%20%0Abegin%0A%0A%20%20%20%20--%20Handle%20the%20special%20case%20of%20delaying%20by%200%20cycles.%0A%20%20%20%20U_CYCLES_EQ_0%20%3A%20if%20CYCLES%20%3D%200%20generate%0A%20%20%20%20%20%20%20%20output%20%3C%3D%20input%3B%0A%20%20%20%20end%20generate%20U_CYCLES_EQ_0%3B%0A%0A%20%20%20%20--%20Handle%20all%20positive%20delays.%0A%20%20%20%20U_CYCLES_GT_0%20%3A%20if%20CYCLES%20%3E%200%20generate%0A%0A%20%20%20%20%20%20%20%20--%20Note%20that%20unlike%20the%20structural%20delay%20example%2C%20the%20array%20here%0A%20%20%20%20%20%20%20%20--%20has%20a%20range%20of%200%20to%20CYCLES-1.%20The%20reason%20for%20the%20difference%20is%20that%0A%20%20%20%20%20%20%20%20--%20in%20the%20structural%20example%2C%20the%20array%20represented%20the%20chain%20of%0A%20%20%20%20%20%20%20%20--%20connections%20between%20registers.%20In%20this%20example%2C%20the%20array%20represents%0A%20%20%20%20%20%20%20%20--%20just%20the%20outputs%20of%20the%20registers.%0A%20%20%20%20%20%20%20%20type%20reg_array_t%20is%20array%20(0%20to%20CYCLES-1)%20of%20std_logic_vector(WIDTH-1%20downto%200)%3B%0A%20%20%20%20%20%20%20%20signal%20regs%20%3A%20reg_array_t%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20begin%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20process(clk%2C%20rst)%0A%20%20%20%20%20%20%20%20begin%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(rst%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20If%20an%20initialization%20value%20is%20provided%2C%20use%20it%2C%20otherwise%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20reset%20to%200.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(RESET_VALUE%20%2F%3D%20%22%22)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20i%20in%200%20to%20CYCLES-1%20loop%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20regs(i)%20%3C%3D%20RESET_VALUE%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20loop%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20i%20in%200%20to%20CYCLES-1%20loop%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20regs(i)%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20loop%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20elsif%20(clk&#39;event%20and%20clk%20%3D%20&#39;1&#39;)%20then%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(en%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20regs(0)%20%3C%3D%20input%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20The%20if%20statements%20isn&#39;t%20needed%2C%20but%20it%20gets%20rid%20of%20null%20range%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20warning%20when%20CYCLES%20%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(CYCLES%20%3E%201)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20i%20in%200%20to%20CYCLES-2%20loop%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(en%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20regs(i%2B1)%20%3C%3D%20regs(i)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20loop%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20end%20process%3B%0A%0A%20%20%20%20%20%20%20%20output%20%3C%3D%20regs(CYCLES-1)%3B%0A%0A%20%20%20%20end%20generate%20U_CYCLES_GT_0%3B%0A%0Aend%20FF%3B%0A" style="text-decoration:none !important;" download="delay.vhd"><code style="border:1px solid var(--vp-c-brand-darker);color:var(--vp-c-brand-darker);padding:0.4em 0.8em;margin:0 0.8em 0.4em 0;">delay.vhd</code></a><a href="data:text/plain;charset=utf-8,--%20Greg%20Stitt%0A--%20University%20of%20Florida%0A%0A--%20Basic%20testbench%20for%20delay.vhd.%20Demonstrates%20use%20of%20random%20numbers.%0A--%0A--%20NOTE%3A%20This%20is%20an%20example%20of%20where%20using%20a%20SystemVerilog%20testbench%20would%0A--%20be%20a%20better%20idea.%20This%20will%20be%20illustrated%20in%20the%20testbenches%20section.%0A%0Alibrary%20ieee%3B%0Ause%20ieee.std_logic_1164.all%3B%0A%0A--%20A%20register%20to%20be%20used%20by%20the%20reference%20model%20in%20the%20testbench.%0A%0Aentity%20delay_reg%20is%0A%20%20%20%20generic(WIDTH%20%3A%20positive%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20RESET_VALUE%20%3A%20std_logic_vector%20%3A%3D%20%22%22)%3B%0A%20%20%20%20port(clk%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20%20rst%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20%20en%20%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20%20input%20%20%3A%20in%20%20std_logic_vector(WIDTH-1%20downto%200)%3B%0A%20%20%20%20%20%20%20%20%20output%20%3A%20out%20std_logic_vector(WIDTH-1%20downto%200))%3B%0Aend%20delay_reg%3B%0A%0Aarchitecture%20BHV%20of%20delay_reg%20is%0Abegin%0A%20%20%20%20process(clk%2C%20rst)%0A%20%20%20%20begin%0A%20%20%20%20%20%20%20%20if%20(rst%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(RESET_VALUE%20%2F%3D%20%22%22)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20RESET_VALUE%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20elsif%20(rising_edge(clk))%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(en%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20input%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20end%20if%3B%20%20%20%20%20%20%20%0A%20%20%20%20end%20process%3B%0Aend%20BHV%3B%0A%0A%0Alibrary%20ieee%3B%0Ause%20ieee.std_logic_1164.all%3B%0Ause%20ieee.numeric_std.all%3B%0Ause%20ieee.math_real.all%3B%0A%0A--%20The%20delay%20testbench.%0A%0Aentity%20delay_tb%20is%0Aend%20delay_tb%3B%0A%0Aarchitecture%20random_tb%20of%20delay_tb%20is%0A%0A%20%20%20%20constant%20NUM_TESTS%20%3A%20integer%20%3A%3D%2010000%3B%0A%20%20%20%20%0A%20%20%20%20constant%20CYCLES%20%3A%20natural%20%20%3A%3D%205%3B%0A%20%20%20%20constant%20WIDTH%20%20%3A%20positive%20%3A%3D%208%3B%0A%20%20%20%20constant%20RESET_VALUE%20%3A%20std_logic_vector(WIDTH-1%20downto%200)%20%3A%3D%20(others%20%3D%3E%20&#39;1&#39;)%3B%0A%20%20%20%20%0A%20%20%20%20signal%20clk_en%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20std_logic%20%3A%3D%20&#39;1&#39;%3B%0A%20%20%20%20signal%20clk%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20std_logic%20%3A%3D%20&#39;0&#39;%3B%0A%20%20%20%20signal%20rst%2C%20en%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20std_logic%3B%0A%20%20%20%20signal%20input%2C%20output%2C%20output_correct%20%3A%20std_logic_vector(WIDTH-1%20downto%200)%3B%0A%20%20%20%20%0Abegin%0A%20%20%20%20%0A%20%20%20%20DUT%20%3A%20entity%20work.delay%0A%20%20%20%20%20%20%20%20generic%20map%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20WIDTH%20%20%3D%3E%20WIDTH%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20CYCLES%20%3D%3E%20CYCLES%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20RESET_VALUE%20%3D%3E%20RESET_VALUE)%0A%20%20%20%20%20%20%20%20port%20map%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20clk%20%20%20%20%3D%3E%20clk%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20rst%20%20%20%20%3D%3E%20rst%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20en%20%20%20%20%20%3D%3E%20en%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20input%20%20%3D%3E%20input%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20output%20%3D%3E%20output%0A%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%0A%20%20%20%20clk%20%3C%3D%20not%20clk%20and%20clk_en%20after%205%20ns%3B%0A%0A%20%20%20%20process%0A%20%20%20%20%20%20%20%20variable%20seed1%2C%20seed2%20%3A%20positive%20%3A%3D%201%3B%0A%20%20%20%20%20%20%20%20variable%20rand_val%20%20%20%20%20%3A%20real%3B%0A%20%20%20%20begin%0A%20%20%20%20%20%20%20%20rst%20%20%20%3C%3D%20&#39;1&#39;%3B%0A%20%20%20%20%20%20%20%20en%20%20%20%20%3C%3D%20&#39;0&#39;%3B%0A%20%20%20%20%20%20%20%20input%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%0A%20%20%20%20%20%20%20%20for%20i%20in%200%20to%203%20loop%0A%20%20%20%20%20%20%20%20%20%20%20%20wait%20until%20rising_edge(clk)%3B%0A%20%20%20%20%20%20%20%20end%20loop%3B%0A%0A%20%20%20%20%20%20%20%20rst%20%3C%3D%20&#39;0&#39;%3B%0A%20%20%20%20%20%20%20%20wait%20until%20rising_edge(clk)%3B%0A%0A%20%20%20%20%20%20%20%20for%20i%20in%200%20to%20NUM_TESTS-1%20loop%0A%20%20%20%20%20%20%20%20%20%20%20%20uniform(seed1%2C%20seed2%2C%20rand_val)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20input%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%3D%20std_logic_vector(to_unsigned(integer(floor(rand_val%20*%20real(2**WIDTH-1)))%2C%20WIDTH))%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20uniform(seed1%2C%20seed2%2C%20rand_val)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(rand_val%20%3E%200.75)%20then%20en%20%3C%3D%20&#39;1&#39;%3B%20else%20en%20%3C%3D%20&#39;0&#39;%3B%20end%20if%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20wait%20until%20rising_edge(clk)%3B%0A%20%20%20%20%20%20%20%20end%20loop%3B%0A%0A%20%20%20%20%20%20%20%20--%20Disable%20the%20clock%20to%20terminate%20the%20simulation.%0A%20%20%20%20%20%20%20%20clk_en%20%3C%3D%20&#39;0&#39;%3B%0A%20%20%20%20%20%20%20%20report%20%22Tests%20completed.%22%3B%0A%20%20%20%20%20%20%20%20wait%3B%0A%20%20%20%20end%20process%3B%0A%0A%20%20%20%20--%20The%20output%20of%20the%20delay%20should%20match%20the%20reference%20model%20every%20cycle.%0A%20%20%20%20assert(not%20(rising_edge(clk)%20and%20output%20%2F%3D%20output_correct))%3B%0A%0A%20%20%20%20--------------------------------------------------------------------%0A%20%20%20%20--%20Reference%20model%0A%0A%20%20%20%20CYCLES_EQ_0%20%3A%20if%20(CYCLES%20%3D%200)%20generate%20%20%20%20%0A%20%20%20%20%20%20%20%20output_correct%20%3C%3D%20input%3B%0A%20%20%20%20end%20generate%20CYCLES_EQ_0%3B%0A%0A%20%20%20%20CYCLES_GT_0%20%3A%20if%20(CYCLES%20%3E%200)%20generate%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20type%20reg_array_t%20is%20array%20(0%20to%20CYCLES)%20of%20std_logic_vector(WIDTH-1%20downto%200)%3B%0A%20%20%20%20%20%20%20%20signal%20d%20%3A%20reg_array_t%3B%0A%20%20%20%20begin%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20U_REGS%20%3A%20for%20i%20in%200%20to%20CYCLES-1%20generate%0A%20%20%20%20%20%20%20%20%20%20%20%20U_REG%20%3A%20entity%20work.delay_reg%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20generic%20map%20(WIDTH%20%3D%3E%20WIDTH%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20RESET_VALUE%20%3D%3E%20RESET_VALUE)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20port%20map%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20clk%20%20%20%20%3D%3E%20clk%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rst%20%20%20%20%3D%3E%20rst%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20en%20%20%20%20%20%3D%3E%20en%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20input%20%20%3D%3E%20d(i)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3D%3E%20d(i%2B1)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20%20%20%20%20end%20generate%3B%0A%0A%20%20%20%20%20%20%20%20d(0)%20%3C%3D%20input%3B%0A%20%20%20%20%20%20%20%20output_correct%20%3C%3D%20d(CYCLES)%3B%0A%20%20%20%20end%20generate%20CYCLES_GT_0%3B%0A%20%20%20%20%0Aend%20random_tb%3B%0A" style="text-decoration:none !important;" download="delay_tb.vhd"><code style="border:1px solid var(--vp-c-brand-darker);color:var(--vp-c-brand-darker);padding:0.4em 0.8em;margin:0 0.8em 0.4em 0;">delay_tb.vhd</code></a></div><div style="font-size:0.8em;font-weight:bold;margin-top:1em;"> If your browser displays the code as plain text, press <code style="font-size:inherit;">Ctrl/Cmd</code> + <code style="font-size:inherit;">S</code> to save it. </div></details><h2 id="brief" tabindex="-1">Brief <a class="header-anchor" href="#brief" aria-hidden="true">#</a></h2><ul><li><p>Illustrates behavioral alternative to earlier structural delay that still synthesizes the same circuit.</p></li><li><p>Illustrates default input values.</p></li><li><p>Illustrates synthesis attributes to prevent inferring of non-flip-flop resources (e.g., embedded RAM).</p></li><li><p>NOTE: This is very useful entity. I use it in almost every application I work on. I&#39;ve had heavily pipelined applications where delays were the primary resource resource bottleneck.</p></li></ul><h2 id="entity-delay" tabindex="-1">Entity <code>delay</code> <a class="header-anchor" href="#entity-delay" aria-hidden="true">#</a></h2><p>Entity: delay Description: This entity delays an input by a specified number of cycles, while also allowing stalls and specific output values on reset.</p><p>This design synthesizes to the same structure as the delay in the structural architectures section. See the delay.pdf schematic from that section for a reference.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">library</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">use</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">std_logic_1164</span><span style="color:#89DDFF;">.all;</span></span>
<span class="line"></span></code></pre></div><p>Generic Descriptions CYCLES : The length of the delay in cycles (required) WIDTH : The WIDTH of the input signal (required) RESET_VALUE : An initial value (of WIDTH bits) for the first &quot;CYCLES&quot; outputs after a reset. (optional)</p><p>Port Description clk : clock rst : reset (active high) en : enable (active high), &#39;0&#39; stalls the delay pipeline input : The input to be delayed output : The input after CYCLES cycles elapse (assuming no stalls)</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">delay</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">generic(</span><span style="color:#A6ACCD;">CYCLES </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">natural</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">positive</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- Here, we again use an unconstrained vector as a workaround</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- to VHDL 1993 not allowing the use of generics to define other</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- generics. See the reg_flexible entity in the reg.vhd example</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- for an explanation.</span></span>
<span class="line"><span style="color:#A6ACCD;">            RESET_VALUE   </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">&quot;&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">port(</span><span style="color:#A6ACCD;">clk    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">         </span><span style="color:#676E95;">-- Note that just like we can have default values for generics, we</span></span>
<span class="line"><span style="color:#A6ACCD;">         </span><span style="color:#676E95;">-- can also have default values for inputs. Here, I use a default</span></span>
<span class="line"><span style="color:#A6ACCD;">         </span><span style="color:#676E95;">-- value of &#39;0&#39; for reset and &#39;1&#39; for enable because to optimize timing</span></span>
<span class="line"><span style="color:#A6ACCD;">         </span><span style="color:#676E95;">-- of pipelines, I very often never reset the delay, and always have</span></span>
<span class="line"><span style="color:#A6ACCD;">         </span><span style="color:#676E95;">-- it enabled. By providing default values, it saves me from having</span></span>
<span class="line"><span style="color:#A6ACCD;">         </span><span style="color:#676E95;">-- to explicitly make these connections in a port map.         </span></span>
<span class="line"><span style="color:#A6ACCD;">         rst    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">         en     </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">         </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">         </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">out</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">delay</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="arch-ff-of-delay" tabindex="-1">Arch <code>FF</code> of <a href="#entity-delay"><code>delay</code></a> <a class="header-anchor" href="#arch-ff-of-delay" aria-hidden="true">#</a></h3><p>Illustrates how to create the delay using flip flop resources. Later examples will illustrate implementations for other resource types.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">architecture</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FF</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">delay</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- FPGA synthesis tools will often try to infer more coarse-grained</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- primitives for shift regsiters (e.g., embedded memory). In many cases,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- this is an effective optimization, but in other cases we might explicitly</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- want flip-flops. Synthesis tools usually have specific attributes to</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- turn off such functionality. The example below illustrates how to disable</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- shift register recognition in Intel Quartus. Xilinx tools likely have</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- similar attributes.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--attribute altera_attribute       : string;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--attribute altera_attribute of FF : architecture is &quot;-name AUTO_SHIFT_REGISTER_RECOGNITION OFF&quot;;    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">begin</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- Handle the special case of delaying by 0 cycles.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">U_CYCLES_EQ_0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> CYCLES </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">generate</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">generate</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">U_CYCLES_EQ_0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- Handle all positive delays.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">U_CYCLES_GT_0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> CYCLES </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">generate</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- Note that unlike the structural delay example, the array here</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- has a range of 0 to CYCLES-1. The reason for the difference is that</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- in the structural example, the array represented the chain of</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- connections between registers. In this example, the array represents</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- just the outputs of the registers.</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">type</span><span style="color:#A6ACCD;"> reg_array_t </span><span style="color:#89DDFF;">is</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">array</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">to</span><span style="color:#A6ACCD;"> CYCLES</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">signal</span><span style="color:#A6ACCD;"> regs </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> reg_array_t</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">begin</span><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">process(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- If an initialization value is provided, use it, otherwise</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- reset to 0.</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">RESET_VALUE </span><span style="color:#89DDFF;">/=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">&quot;&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">to</span><span style="color:#A6ACCD;"> CYCLES</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop</span></span>
<span class="line"><span style="color:#A6ACCD;">                        regs</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> RESET_VALUE</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop;</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">to</span><span style="color:#A6ACCD;"> CYCLES</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop</span></span>
<span class="line"><span style="color:#A6ACCD;">                        regs</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop;</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">elsif</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">&#39;event</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">and</span><span style="color:#A6ACCD;"> clk </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">en </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                    regs</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- The if statements isn&#39;t needed, but it gets rid of null range</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- warning when CYCLES = 1</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CYCLES </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">to</span><span style="color:#A6ACCD;"> CYCLES</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">en </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                            regs</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> regs</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop;</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> regs</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CYCLES</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">generate</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">U_CYCLES_GT_0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FF</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="entity-delay-reg" tabindex="-1">Entity <code>delay_reg</code> <a class="header-anchor" href="#entity-delay-reg" aria-hidden="true">#</a></h2><p>Basic testbench for delay.vhd. Demonstrates use of random numbers.</p><p>NOTE: This is an example of where using a SystemVerilog testbench would be a better idea. This will be illustrated in the testbenches section.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">library</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">use</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">std_logic_1164</span><span style="color:#89DDFF;">.all;</span></span>
<span class="line"></span></code></pre></div><p>A register to be used by the reference model in the testbench.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">delay_reg</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">generic(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">positive</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            RESET_VALUE </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">&quot;&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">port(</span><span style="color:#A6ACCD;">clk    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">         rst    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">         en     </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">         </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">         </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">out</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">delay_reg</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="arch-bhv-of-delay-reg" tabindex="-1">Arch <code>BHV</code> of <a href="#entity-delay-reg"><code>delay_reg</code></a> <a class="header-anchor" href="#arch-bhv-of-delay-reg" aria-hidden="true">#</a></h3><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">architecture</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">delay_reg</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">process(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">RESET_VALUE </span><span style="color:#89DDFF;">/=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">&quot;&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> RESET_VALUE</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">elsif</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">en </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span><span style="color:#A6ACCD;">       </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="entity-delay-tb" tabindex="-1">Entity <code>delay_tb</code> <a class="header-anchor" href="#entity-delay-tb" aria-hidden="true">#</a></h2><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">library</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">use</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">std_logic_1164</span><span style="color:#89DDFF;">.all;</span></span>
<span class="line"><span style="color:#89DDFF;">use</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">numeric_std</span><span style="color:#89DDFF;">.all;</span></span>
<span class="line"><span style="color:#89DDFF;">use</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">math_real</span><span style="color:#89DDFF;">.all;</span></span>
<span class="line"></span></code></pre></div><p>The delay testbench.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">delay_tb</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">delay_tb</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="arch-random-tb-of-delay-tb" tabindex="-1">Arch <code>random_tb</code> of <a href="#entity-delay-tb"><code>delay_tb</code></a> <a class="header-anchor" href="#arch-random-tb-of-delay-tb" aria-hidden="true">#</a></h3><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">architecture</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">random_tb</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">delay_tb</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">constant</span><span style="color:#A6ACCD;"> NUM_TESTS </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">integer</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">constant</span><span style="color:#A6ACCD;"> CYCLES </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">natural</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">constant</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">positive</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">constant</span><span style="color:#A6ACCD;"> RESET_VALUE </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">signal</span><span style="color:#A6ACCD;"> clk_en                        </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">signal</span><span style="color:#A6ACCD;"> clk                           </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">signal</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> en                       </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">signal</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">output</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> output_correct </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">DUT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">work</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">delay</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">generic</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">map</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            CYCLES </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> CYCLES</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            RESET_VALUE </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> RESET_VALUE</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">port</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">map</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">            clk    </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> clk</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            rst    </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            en     </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> en</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">output</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    clk </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">not</span><span style="color:#A6ACCD;"> clk </span><span style="color:#89DDFF;">and</span><span style="color:#A6ACCD;"> clk_en </span><span style="color:#89DDFF;">after</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ns</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">process</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">variable</span><span style="color:#A6ACCD;"> seed1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> seed2 </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">positive</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">variable</span><span style="color:#A6ACCD;"> rand_val     </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">real</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">        rst   </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        en    </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">wait</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">until</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        rst </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">wait</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">until</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">to</span><span style="color:#A6ACCD;"> NUM_TESTS</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop</span></span>
<span class="line"><span style="color:#A6ACCD;">            uniform</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">seed1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> seed2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rand_val</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">                        </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">to_unsigned</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">integer</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">floor</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rand_val </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">real</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">**</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">))),</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">            uniform</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">seed1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> seed2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rand_val</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rand_val </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0.75</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span><span style="color:#A6ACCD;"> en </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">else</span><span style="color:#A6ACCD;"> en </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">wait</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">until</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- Disable the clock to terminate the simulation.</span></span>
<span class="line"><span style="color:#A6ACCD;">        clk_en </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">report</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">&quot;Tests completed.&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">wait;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- The output of the delay should match the reference model every cycle.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">assert(not</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">and</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/=</span><span style="color:#A6ACCD;"> output_correct</span><span style="color:#89DDFF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- Reference model</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">CYCLES_EQ_0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CYCLES </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">generate</span><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">        output_correct </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">generate</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">CYCLES_EQ_0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">CYCLES_GT_0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CYCLES </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">generate</span><span style="color:#A6ACCD;">       </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">type</span><span style="color:#A6ACCD;"> reg_array_t </span><span style="color:#89DDFF;">is</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">array</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">to</span><span style="color:#A6ACCD;"> CYCLES</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">signal</span><span style="color:#A6ACCD;"> d </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> reg_array_t</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">begin</span><span style="color:#A6ACCD;">       </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">U_REGS</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">to</span><span style="color:#A6ACCD;"> CYCLES</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">generate</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">U_REG</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">work</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">delay_reg</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">generic</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">map</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                             RESET_VALUE </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> RESET_VALUE</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">port</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">map</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">                    clk    </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> clk</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                    rst    </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                    en     </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> en</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> d</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> d</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">generate;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        d</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        output_correct </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> d</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CYCLES</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">generate</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">CYCLES_GT_0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">random_tb</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div>`,28),e=[o];function t(r,c,D,C,y,A){return a(),n("div",null,e)}const d=s(p,[["render",t]]);export{i as __pageData,d as default};
