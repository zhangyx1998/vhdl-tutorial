<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Register | VHDL Tutorial</title>
    <meta name="description" content="Quickly get started with VHDL language">
    <link rel="stylesheet" href="/vhdl-tutorial/assets/style.dbbae951.css">
    <link rel="modulepreload" href="/vhdl-tutorial/assets/app.caac86f1.js">
    <link rel="modulepreload" href="/vhdl-tutorial/assets/sequential_reg.md.6668b9bc.lean.js">
    
    <link rel="icon" type="image/png" href="/vhdl-tutorial/icon.png">
  <meta property="og:type" content="website">
  <meta property="og:title" content="VHDL Tutorial">
  <meta property="og:image" content="/icon.png">
  <meta property="og:url" content="https://example.com">
  <meta property="og:description" content="Yet Another VHDL Tutorial">
  <meta name="theme-color" content="#646cff">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-3ff9331b><!--[--><!--]--><!--[--><span tabindex="-1" data-v-f637ee78></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-f637ee78> Skip to content </a><!--]--><!----><header class="VPNav" data-v-3ff9331b data-v-863eec2a><div class="VPNavBar has-sidebar" data-v-863eec2a data-v-fb57374e><div class="container" data-v-fb57374e><div class="VPNavBarTitle has-sidebar" data-v-fb57374e data-v-aaed7263><a class="title" href="/vhdl-tutorial/" data-v-aaed7263><!--[--><!--]--><!--[--><img class="VPImage logo" src="/vhdl-tutorial/icon.png" data-v-d6e8f4d1><!--]--><!--[-->VHDL Tutorial<!--]--><!--[--><!--]--></a></div><div class="content" data-v-fb57374e><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-fb57374e data-v-d8cdd395><span id="main-nav-aria-label" class="visually-hidden" data-v-d8cdd395>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-d8cdd395 data-v-aeb1c475><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-aeb1c475><span class="text" data-v-aeb1c475><!----> Basics <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-aeb1c475><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-aeb1c475><div class="VPMenu" data-v-aeb1c475 data-v-079aa243><div class="items" data-v-079aa243><!--[--><!--[--><div class="VPMenuLink" data-v-079aa243 data-v-d3c02515><a class="VPLink link" href="/vhdl-tutorial/combinational/README.html" data-v-d3c02515 data-v-97a44ddd><!--[-->Combinational Logic<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-079aa243 data-v-d3c02515><a class="VPLink link" href="/vhdl-tutorial/structural/README.html" data-v-d3c02515 data-v-97a44ddd><!--[-->Structural Logic<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-079aa243 data-v-d3c02515><a class="VPLink link" href="/vhdl-tutorial/sequential/README.html" data-v-d3c02515 data-v-97a44ddd><!--[-->Sequential Logic<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-d8cdd395 data-v-aeb1c475><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-aeb1c475><span class="text" data-v-aeb1c475><!----> Advanced <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-aeb1c475><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-aeb1c475><div class="VPMenu" data-v-aeb1c475 data-v-079aa243><div class="items" data-v-079aa243><!--[--><!--[--><div class="VPMenuLink" data-v-079aa243 data-v-d3c02515><a class="VPLink link" href="/vhdl-tutorial/fsm/README.html" data-v-d3c02515 data-v-97a44ddd><!--[-->Finite-State Machines<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-079aa243 data-v-d3c02515><a class="VPLink link" href="/vhdl-tutorial/fsmd/README.html" data-v-d3c02515 data-v-97a44ddd><!--[-->Finite-State Machines + Datapaths<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-d8cdd395 data-v-aeb1c475><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-aeb1c475><span class="text" data-v-aeb1c475><!----> Extras <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-aeb1c475><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-aeb1c475><div class="VPMenu" data-v-aeb1c475 data-v-079aa243><div class="items" data-v-079aa243><!--[--><!--[--><div class="VPMenuLink" data-v-079aa243 data-v-d3c02515><a class="VPLink link" href="/vhdl-tutorial/404.html" data-v-d3c02515 data-v-97a44ddd><!--[-->misc (TBD)<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-079aa243 data-v-d3c02515><a class="VPLink link" href="/vhdl-tutorial/404.html" data-v-d3c02515 data-v-97a44ddd><!--[-->testbenches (TBD)<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-fb57374e data-v-d70ebc80><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-d70ebc80 data-v-a471238a data-v-e9a46395><span class="check" data-v-e9a46395><span class="icon" data-v-e9a46395><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-a471238a><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-a471238a><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-fb57374e data-v-f53bea1d data-v-aeb1c475><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-aeb1c475><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-aeb1c475><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-aeb1c475><div class="VPMenu" data-v-aeb1c475 data-v-079aa243><!----><!--[--><!--[--><!----><div class="group" data-v-f53bea1d><div class="item appearance" data-v-f53bea1d><p class="label" data-v-f53bea1d>Appearance</p><div class="appearance-action" data-v-f53bea1d><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-f53bea1d data-v-a471238a data-v-e9a46395><span class="check" data-v-e9a46395><span class="icon" data-v-e9a46395><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-a471238a><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-a471238a><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-fb57374e data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-3ff9331b data-v-d68ed9b2><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-d68ed9b2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-d68ed9b2><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-d68ed9b2>Menu</span></button><a class="top-link" href="#" data-v-d68ed9b2> Return to top </a></div><aside class="VPSidebar" data-v-3ff9331b data-v-b10799cf><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-b10799cf><span class="visually-hidden" id="sidebar-aria-label" data-v-b10799cf> Sidebar Navigation </span><!--[--><div class="group" data-v-b10799cf><section class="VPSidebarGroup collapsible" data-v-b10799cf data-v-9c72bf2f><div class="title" role="button" data-v-9c72bf2f><h2 class="title-text" data-v-9c72bf2f>Combinational Logic</h2><div class="action" data-v-9c72bf2f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-9c72bf2f><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-9c72bf2f><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-9c72bf2f><!--[--><a class="VPLink link link" href="/vhdl-tutorial/combinational/README.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Introduction</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/combinational/mux_2x1.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>2:1 mux</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/combinational/priority_encoder_4in.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>4-input Priority Encoder</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/combinational/priority_encoder.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Generic Priority Encoder</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/combinational/add.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Adders</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/combinational/mult.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Multipliers</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/combinational/alu.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>ALU</span><!----><!--]--><!----></a><!--]--></div></section></div><div class="group" data-v-b10799cf><section class="VPSidebarGroup collapsible" data-v-b10799cf data-v-9c72bf2f><div class="title" role="button" data-v-9c72bf2f><h2 class="title-text" data-v-9c72bf2f>Structural Logic</h2><div class="action" data-v-9c72bf2f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-9c72bf2f><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-9c72bf2f><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-9c72bf2f><!--[--><a class="VPLink link link" href="/vhdl-tutorial/structural/README.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Introduction</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/structural/mux4x1.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>4:1 mux</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/structural/ripple_carry_adder.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Ripple-Carry Adder</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/structural/delay.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Delay</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/404.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Add Tree (TBD)</span><!----><!--]--><!----></a><!--]--></div></section></div><div class="group" data-v-b10799cf><section class="VPSidebarGroup collapsible" data-v-b10799cf data-v-9c72bf2f><div class="title" role="button" data-v-9c72bf2f><h2 class="title-text" data-v-9c72bf2f>Sequential Logic</h2><div class="action" data-v-9c72bf2f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-9c72bf2f><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-9c72bf2f><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-9c72bf2f><!--[--><a class="VPLink link link" href="/vhdl-tutorial/sequential/README.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Introduction</span><!----><!--]--><!----></a><a class="VPLink link link active" href="/vhdl-tutorial/sequential/reg.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Register</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/sequential/seq_example.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Behavioral Code Syn. Examples</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/sequential/delay.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Delay</span><!----><!--]--><!----></a><a class="VPLink link link" href="/vhdl-tutorial/sequential/counter.html" data-v-9c72bf2f data-v-2f312984 data-v-97a44ddd><!--[--><span class="link-text" data-v-2f312984>Counter</span><!----><!--]--><!----></a><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-3ff9331b data-v-54263dce><div class="VPDoc has-sidebar has-aside" data-v-54263dce data-v-680f4f24><div class="container" data-v-680f4f24><div class="aside" data-v-680f4f24><div class="aside-curtain" data-v-680f4f24></div><div class="aside-container" data-v-680f4f24><div class="aside-content" data-v-680f4f24><div class="VPDocAside" data-v-680f4f24 data-v-3598569e><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-3598569e data-v-77f3f933><div class="content" data-v-77f3f933><div class="outline-marker" data-v-77f3f933></div><div class="outline-title" data-v-77f3f933>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-77f3f933><span class="visually-hidden" id="doc-outline-aria-label" data-v-77f3f933> Table of Contents for current page </span><ul class="root" data-v-77f3f933><!--[--><li data-v-77f3f933><a class="outline-link" href="#brief" data-v-77f3f933>Brief</a><ul data-v-77f3f933><!--[--><!--]--></ul></li><li data-v-77f3f933><a class="outline-link" href="#entity-reg-async-rst" data-v-77f3f933>Entity reg_async_rst</a><ul data-v-77f3f933><!--[--><li data-v-77f3f933><a class="outline-link nested" href="#arch-bhv-of-reg-async-rst" data-v-77f3f933>Arch BHV of reg_async_rst</a></li><!--]--></ul></li><li data-v-77f3f933><a class="outline-link" href="#entity-reg-sync-rst" data-v-77f3f933>Entity reg_sync_rst</a><ul data-v-77f3f933><!--[--><li data-v-77f3f933><a class="outline-link nested" href="#arch-bhv-of-reg-sync-rst" data-v-77f3f933>Arch BHV of reg_sync_rst</a></li><!--]--></ul></li><li data-v-77f3f933><a class="outline-link" href="#entity-reg-en-async-rst" data-v-77f3f933>Entity reg_en_async_rst</a><ul data-v-77f3f933><!--[--><li data-v-77f3f933><a class="outline-link nested" href="#arch-bhv-of-reg-en-async-rst" data-v-77f3f933>Arch BHV of reg_en_async_rst</a></li><!--]--></ul></li><li data-v-77f3f933><a class="outline-link" href="#entity-reg-en-sync-rst" data-v-77f3f933>Entity reg_en_sync_rst</a><ul data-v-77f3f933><!--[--><li data-v-77f3f933><a class="outline-link nested" href="#arch-bhv-of-reg-en-sync-rst" data-v-77f3f933>Arch BHV of reg_en_sync_rst</a></li><li data-v-77f3f933><a class="outline-link nested" href="#arch-bad-of-reg-en-sync-rst" data-v-77f3f933>Arch BAD of reg_en_sync_rst</a></li><!--]--></ul></li><li data-v-77f3f933><a class="outline-link" href="#entity-reg-flexible" data-v-77f3f933>Entity reg_flexible</a><ul data-v-77f3f933><!--[--><li data-v-77f3f933><a class="outline-link nested" href="#arch-bhv1-of-reg-flexible" data-v-77f3f933>Arch BHV1 of reg_flexible</a></li><li data-v-77f3f933><a class="outline-link nested" href="#arch-bhv2-of-reg-flexible" data-v-77f3f933>Arch BHV2 of reg_flexible</a></li><!--]--></ul></li><li data-v-77f3f933><a class="outline-link" href="#entity-reg" data-v-77f3f933>Entity reg</a><ul data-v-77f3f933><!--[--><li data-v-77f3f933><a class="outline-link nested" href="#arch-default-arch-of-reg" data-v-77f3f933>Arch default_arch of reg</a></li><!--]--></ul></li><li data-v-77f3f933><a class="outline-link" href="#entity-reg-tb" data-v-77f3f933>Entity reg_tb</a><ul data-v-77f3f933><!--[--><li data-v-77f3f933><a class="outline-link nested" href="#arch-random-tb-of-reg-tb" data-v-77f3f933>Arch random_tb of reg_tb</a></li><!--]--></ul></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3598569e></div><!--[--><!--[--><!--[--><!--[--><!--[--><a class="banner" href="http://www.gstitt.ece.ufl.edu/courses/eel4720_5721/" target="_blank" data-v-698e08df><img width="26" height="26" src="/vhdl-tutorial/vhdl.png" data-v-698e08df><span data-v-698e08df><p class="extra-info" data-v-698e08df>EEL4720/5721 Fall 2022</p><p class="heading" data-v-698e08df>Course Homepage</p><p class="extra-info" data-v-698e08df>Reconfigurable Computing</p></span></a><h3 style="font-weight:bold;margin:0.3em;" data-v-698e08df>Related Websites</h3><div class="VPDocAsideSponsors" data-v-698e08df><div class="VPSponsors vp-sponsor aside"><!--[--><section class="vp-sponsor-section"><!----><div class="VPSponsorsGrid vp-sponsor-grid mini"><!--[--><div class="vp-sponsor-grid-item"><a class="vp-sponsor-grid-link" href="https://ufl.edu/" target="_blank" rel="sponsored noopener"><article class="vp-sponsor-grid-box"><h4 class="visually-hidden">University of Florida</h4><img class="vp-sponsor-grid-image" src="/vhdl-tutorial/brands/ufl.png" alt="University of Florida"></article></a></div><div class="vp-sponsor-grid-item"><a class="vp-sponsor-grid-link" href="https://ufl.edu/" target="_blank" rel="sponsored noopener"><article class="vp-sponsor-grid-box"><h4 class="visually-hidden">University of Florida</h4><img class="vp-sponsor-grid-image" src="/vhdl-tutorial/brands/ufl.png" alt="University of Florida"></article></a></div><!--]--></div></section><section class="vp-sponsor-section"><!----><div class="VPSponsorsGrid vp-sponsor-grid xmini"><!--[--><div class="vp-sponsor-grid-item"><a class="vp-sponsor-grid-link" href="https://ufl.edu/" target="_blank" rel="sponsored noopener"><article class="vp-sponsor-grid-box"><h4 class="visually-hidden">University of Florida</h4><img class="vp-sponsor-grid-image" src="/vhdl-tutorial/brands/ufl.png" alt="University of Florida"></article></a></div><div class="vp-sponsor-grid-item"><a class="vp-sponsor-grid-link" href="https://ufl.edu/" target="_blank" rel="sponsored noopener"><article class="vp-sponsor-grid-box"><h4 class="visually-hidden">University of Florida</h4><img class="vp-sponsor-grid-image" src="/vhdl-tutorial/brands/ufl.png" alt="University of Florida"></article></a></div><div class="vp-sponsor-grid-item"><a class="vp-sponsor-grid-link" href="https://ufl.edu/" target="_blank" rel="sponsored noopener"><article class="vp-sponsor-grid-box"><h4 class="visually-hidden">University of Florida</h4><img class="vp-sponsor-grid-image" src="/vhdl-tutorial/brands/ufl.png" alt="University of Florida"></article></a></div><div class="vp-sponsor-grid-item"><a class="vp-sponsor-grid-link" href="https://ufl.edu/" target="_blank" rel="sponsored noopener"><article class="vp-sponsor-grid-box"><h4 class="visually-hidden">University of Florida</h4><img class="vp-sponsor-grid-image" src="/vhdl-tutorial/brands/ufl.png" alt="University of Florida"></article></a></div><!--]--></div></section><!--]--></div></div><!--]--><!--]--><!--]--><!--]--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-680f4f24><div class="content-container" data-v-680f4f24><!--[--><!--]--><main class="main" data-v-680f4f24><div style="position:relative;" class="vp-doc _vhdl-tutorial_sequential_reg" data-v-680f4f24><div><h1 id="register" tabindex="-1">Register <a class="header-anchor" href="#register" aria-hidden="true">#</a></h1><details class="details custom-block"><summary>Get source code for this page</summary><div style="display:flex;flex-direction:row;flex-wrap:wrap;"><a href="data:text/plain;charset=utf-8,--%20Greg%20Stitt%0A--%20University%20of%20Florida%0A%0A--%20This%20example%20illustrates%20a%20variety%20of%20different%20register%20entities.%20To%0A--%20simulate%2Fsynthesize%20a%20different%20entity%2C%20change%20the%20comments%20in%20the%20reg%0A--%20entity%20at%20the%20bottom%20of%20this%20file.%0A--%0A--%20A%20full%20discussion%20of%20the%20tradeoffs%20of%20different%20reset%20types%20is%20outside%20the%0A--%20scope%20of%20this%20example%2C%20but%20generally%20for%20FPGA%20designs%20I%20use%20asynchronous%0A--%20resets%20because%20they%20are%20supported%20by%20the%20flip%20flops%20in%20every%20FPGA%20I%20use.%0A--%20Synchronous%20resets%20still%20work%2C%20but%20require%20a%20mux%20in%20front%20of%20the%20flip%20flop%0A--%20That%20mux%20takes%20away%20one%20input%20from%20the%20LUT%20in%20front%20of%20the%20flip%20flop%2C%20which%0A--%20can%20cause%20significant%20increases%20in%20resource%20usage.%0A--%0A--%20Also%2C%20as%20a%20general%20rule%2C%20I%20avoid%20resetting%20registers%20unless%20required.%20For%0A--%20beginners%20I%20highly%20recommend%20resetting%20all%20registers%2C%20but%20once%20you%20are%0A--%20comfortable%20with%20seeing%20&#39;U&#39;%20values%20in%20a%20simulation%2C%20you%20can%20significantly%0A--%20optimize%20a%20design%20by%20only%20resetting%20what%20is%20necessary.%20The%20reason%20for%20this%0A--%20optimization%20is%20that%20reset%20signals%20have%20a%20huge%20fan-out%2C%20which%20makes%20it%0A--%20challenging%20for%20placement%20and%20routing%20to%20create%20a%20good%20solution.%0A%0Alibrary%20ieee%3B%0Ause%20ieee.std_logic_1164.all%3B%0A%0A--%20Entity%3A%20reg_async_rst%0A--%20Description%3A%20Implements%20a%20register%20with%20an%20active%20high%2C%20asynchronous%20reset.%0A%0Aentity%20reg_async_rst%20is%0A%20%20%20%20generic(%0A%20%20%20%20%20%20%20%20WIDTH%20%3A%20positive%0A%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20port(%0A%20%20%20%20%20%20%20%20clk%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20rst%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20input%20%20%3A%20in%20%20std_logic_vector(WIDTH-1%20downto%200)%3B%0A%20%20%20%20%20%20%20%20output%20%3A%20out%20std_logic_vector(WIDTH-1%20downto%200)%0A%20%20%20%20%20%20%20%20)%3B%0Aend%20reg_async_rst%3B%0A%0Aarchitecture%20BHV%20of%20reg_async_rst%20is%0Abegin%0A%20%20%20%20--%20GUIDELINE%201%20FOR%20SEQUENTIAL%20LOGIC%3A%20The%20sensitivity%20list%20should%0A%20%20%20%20--%20only%20have%20clock%20and%20reset%20(if%20there%20is%20an%20asynchronous%20reset).%20It%0A%20%20%20%20--%20technically%20shouldn&#39;t%20hurt%20anything%20if%20you%20include%20other%20signals%2C%20but%0A%20%20%20%20--%20they%20are%20not%20necessary%2C%20can%20slow%20down%20a%20simulation%20by%20needlessly%0A%20%20%20%20--%20retriggering%20the%20process%2C%20and%20might%20confuse%20a%20bad%20synthesis%20tool.%0A%20%20%20%20%0A%20%20%20%20process(clk%2C%20rst)%0A%20%20%20%20begin%0A%20%20%20%20%20%20%20%20--%20SYNTHESIS%20GUIDELINE%202%20FOR%20SEQUENTIAL%20LOGIC%3A%20All%20sequential%20logic%20with%0A%20%20%20%20%20%20%20%20--%20async%20reset%20should%20be%20described%20using%20the%20following%20basic%20structure%3A%0A%20%20%20%20%20%20%20%20--%0A%20%20%20%20%20%20%20%20--%20if%20reset%0A%20%20%20%20%20%20%20%20--%20%20%20handle%20reset%20%0A%20%20%20%20%20%20%20%20--%20elsif%20rising%20clock%20edge%0A%20%20%20%20%20%20%20%20--%20%20%20specify%20all%20non-reset%20functionality%0A%20%20%20%20%20%20%20%20--%20end%20if%0A%20%20%20%20%20%20%20%20--%0A%20%20%20%20%20%20%20%20--%20Do%20not%20try%20to%20come%20up%20with%20another%20way%20of%20specifying%20equivalent%0A%20%20%20%20%20%20%20%20--%20behavior.%20Synthesis%20tools%20often%20require%20this%20template.%0A%20%20%20%20%20%20%20%20--%0A%20%20%20%20%20%20%20%20--%20There%20are%20other%20techniques%20that%20will%20work%20with%20some%20tools%2C%20but%20since%0A%20%20%20%20%20%20%20%20--%20this%20template%20works%20for%20any%20form%20of%20sequential%20logic%2C%20there%20is%20no%0A%20%20%20%20%20%20%20%20--%20need%20to%20change%20it.%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20if%20(rst%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20Reset%20the%20output%20to%20all%200s.%20The%20others%20statement%20sets%20all%20the%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20bits%20equal%20to%20the%20specified%20value.%20It%20is%20part%20of%20a%20more%20general%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20aggregation%20construct%20that%20will%20be%20discussed%20in%20other%20examples.%0A%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20elsif%20(rising_edge(clk))%20then%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20SYNTHESIS%20RULE%3A%20Any%20assignment%20to%20a%20signal%20on%20a%20rising%20clock%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20edge%20will%20be%20synthesized%20as%20a%20register%2C%20where%20the%20LHS%20is%20the%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20output%20of%20the%20register%2C%20and%20the%20RHS%20is%20the%20input.%20This%20might%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20seem%20obvious%20for%20this%20simple%20example%2C%20but%20it%20is%20critically%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20important%20to%20remember%20this%20rule%20for%20bigger%20examples%20because%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20adding%20or%20omitting%20a%20register%20is%20a%20very%20common%20source%20of%20bugs.%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20When%20we%20%22design%20the%20circuit%22%20before%20writing%20the%20code%2C%20a%20huge%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20part%20of%20that%20design%20is%20determining%20the%20number%20of%20registers.%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20To%20ensure%20that%20the%20synthesized%20circuit%20has%20the%20same%20number%20of%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20registers%20as%20our%20design%20circuit%2C%20we%20need%20to%20understand%20how%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20registers%20get%20created%20during%20synthesis.%0A%20%20%20%20%20%20%20%20%20%20%20%20--%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20Note%20that%20variables%20can%20be%20synthesized%20as%20either%20wires%20or%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20registers%20depending%20on%20the%20usage%2C%20which%20will%20be%20explained%20in%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20later%20examples.%0A%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20input%3B%0A%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20end%20process%3B%0Aend%20BHV%3B%0A%0A%0Alibrary%20ieee%3B%0Ause%20ieee.std_logic_1164.all%3B%0A%0A--%20Entity%3A%20reg_sync_rst%0A--%20Description%3A%20Implements%20a%20register%20with%20an%20active%20high%2C%20synchronous%20reset.%0A%0Aentity%20reg_sync_rst%20is%0A%20%20%20%20generic(%0A%20%20%20%20%20%20%20%20WIDTH%20%3A%20positive%0A%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20port(%0A%20%20%20%20%20%20%20%20clk%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20rst%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20input%20%20%3A%20in%20%20std_logic_vector(WIDTH-1%20downto%200)%3B%0A%20%20%20%20%20%20%20%20output%20%3A%20out%20std_logic_vector(WIDTH-1%20downto%200)%0A%20%20%20%20%20%20%20%20)%3B%0Aend%20reg_sync_rst%3B%0A%0Aarchitecture%20BHV%20of%20reg_sync_rst%20is%0Abegin%0A%20%20%20%20--%20For%20a%20synchronous%20reset%2C%20we%20only%20need%20the%20clock%20in%20the%20sensitivity%20list.%0A%20%20%20%20--%20However%2C%20it%20doesn&#39;t%20really%20hurt%20to%20include%20reset%20because%20a%20simulation%20is%0A%20%20%20%20--%20unlikely%20to%20be%20frequently%20resetting%20a%20register%2C%20so%20it%20probably%20won&#39;t%0A%20%20%20%20--%20slow%20down%20the%20simulation%20much.%20Also%2C%20it%20won&#39;t%20affect%20synthesis.%20%0A%20%20%20%20process(clk)%0A%20%20%20%20begin%0A%20%20%20%20%20%20%20%20if%20(rising_edge(clk))%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20For%20the%20synchronous%20reset%2C%20we%20check%20the%20reset%20on%20the%20rising%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20clock%20edge.%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(rst%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20input%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20end%20process%3B%0Aend%20BHV%3B%0A%0A%0Alibrary%20ieee%3B%0Ause%20ieee.std_logic_1164.all%3B%0A%0A--%20Entity%3A%20reg_en_async_rst%0A--%20Description%3A%20Implements%20a%20register%20with%20an%20enable%2C%20and%20an%20active%20high%2C%0A--%20asynchronous%20reset.%20The%20register%20holds%20its%20value%20when%20enable%20isn&#39;t%20asserted.%0A%0Aentity%20reg_en_async_rst%20is%0A%20%20%20%20generic(%0A%20%20%20%20%20%20%20%20WIDTH%20%3A%20positive%0A%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20port(%0A%20%20%20%20%20%20%20%20clk%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20rst%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20en%20%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20input%20%20%3A%20in%20%20std_logic_vector(WIDTH-1%20downto%200)%3B%0A%20%20%20%20%20%20%20%20output%20%3A%20out%20std_logic_vector(WIDTH-1%20downto%200)%0A%20%20%20%20%20%20%20%20)%3B%0Aend%20reg_en_async_rst%3B%0A%0Aarchitecture%20BHV%20of%20reg_en_async_rst%20is%0Abegin%0A%20%20%20%20process(clk%2C%20rst)%0A%20%20%20%20begin%0A%20%20%20%20%20%20%20%20if%20(rst%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20elsif%20(rising_edge(clk))%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20Here%20we%20simply%20add%20an%20if%20statement%20to%20check%20if%20enable%20is%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20asserted.%20Note%20that%20to%20comply%20with%20my%20coding%20guideline%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20this%20has%20to%20be%20done%20on%20the%20rising%20clock%20edge%20since%20it%20isn&#39;t%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20related%20to%20reset.%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(en%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20input%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20end%20process%3B%0Aend%20BHV%3B%0A%0A%0Alibrary%20ieee%3B%0Ause%20ieee.std_logic_1164.all%3B%0A%0A--%20Entity%3A%20reg_en_sync_rst%0A--%20Description%3A%20Implements%20a%20register%20with%20an%20enable%2C%20and%20an%20active%20high%2C%0A--%20synchronous%20reset.%20The%20register%20holds%20its%20value%20when%20enable%20isn&#39;t%20asserted.%0A%0Aentity%20reg_en_sync_rst%20is%0A%20%20%20%20generic(%0A%20%20%20%20%20%20%20%20WIDTH%20%3A%20positive%0A%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20port(%0A%20%20%20%20%20%20%20%20clk%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20rst%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20en%20%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20input%20%20%3A%20in%20%20std_logic_vector(WIDTH-1%20downto%200)%3B%0A%20%20%20%20%20%20%20%20output%20%3A%20out%20std_logic_vector(WIDTH-1%20downto%200)%0A%20%20%20%20%20%20%20%20)%3B%0Aend%20reg_en_sync_rst%3B%0A%0A%0Aarchitecture%20BHV%20of%20reg_en_sync_rst%20is%0Abegin%0A%20%20%20%20process(clk%2C%20rst)%0A%20%20%20%20begin%0A%20%20%20%20%20%20%20%20if%20(rising_edge(clk))%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20Here%20we%20move%20the%20reset%20on%20the%20clock%20edge%20to%20make%20it%20synchronous%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20and%20then%20have%20an%20elsif%20for%20the%20enable.%20Note%20that%20we%20have%20to%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20check%20the%20conditions%20in%20this%20order%20since%20reset%20has%20priority%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20over%20the%20enable.%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(rst%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20elsif%20(en%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20input%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20end%20process%3B%0Aend%20BHV%3B%0A%0A%0A--%20The%20following%20architecture%20is%20an%20example%20of%20a%20violation%20of%20synthesis%20coding%0A--%20guidelines.%20It%20simulates%20perfectly%2C%20and%20is%20semantically%20correct%20in%20terms%20of%0A--%20behavior%2C%20but%20it%20is%20unlikely%20that%20a%20synthesis%20tool%20will%20recognize%20this%20as%0A--%20a%20register%2C%20at%20least%20without%20warnings.%0A--%0A--%20I%20tested%20it%20in%20Quartus%20and%20it%20warned%20about%20en%20not%20being%20in%20the%20sensitivity%0A--%20list%2C%20which%20suggests%20it%20thinks%20it%20is%20combinational%20logic.%20The%20RTL%20viewer%0A--%20shows%20a%20register%2C%20so%20it%20might%20have%20worked%2C%20but%20is%20still%20a%20bad%20idea.%20I%20see%0A--%20student%20code%20all%20the%20time%20that%20works%20in%20simulation%20but%20does%20not%20synthesize%0A--%20correctly%20because%20of%20deviating%20from%20the%20specified%20template.%0Aarchitecture%20BAD%20of%20reg_en_sync_rst%20is%0Abegin%0A%20%20%20%20process(clk%2C%20rst)%0A%20%20%20%20begin%0A%20%20%20%20%20%20%20%20if%20(rising_edge(clk)%20and%20rst%20%3D%20&#39;1&#39;)%20then%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20elsif%20(rising_edge(clk)%20and%20en%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20input%3B%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20end%20process%3B%0Aend%20BAD%3B%0A%0A%0Alibrary%20ieee%3B%0Ause%20ieee.std_logic_1164.all%3B%0A%0A%0A--%20Entity%3A%20reg_en_sync_rst%0A--%20Description%3A%20Implements%20a%20highly%20parameterized%20register%20with%20configurable%0A--%20width%2C%20reset%20type%2C%20reset%20activation%20level%2C%20and%20reset%20value.%0A--%0A--%20As%20tempting%20as%20it%20might%20be%20to%20use%20this%20entity%20everywhere%20due%20to%20its%0A--%20versatility%2C%20it%20quickly%20becomes%20problematic%20structurally%20instantiating%20a%0A--%20register%20everywhere%20you%20need%20one.%20I%20almost%20never%20do%20this%20unless%20I%20know%0A--%20I%20need%20the%20versatility%2C%20which%20is%20very%20rare.%0A--%0A--%20Generally%2C%20since%20creating%20a%20register%20only%20requires%20a%20single%20assignment%0A--%20on%20a%20rising%20clock%20edge%2C%20I&#39;ll%20just%20add%20an%20assignment%20to%20existing%20code%20to%0A--%20create%20more%20registers.%20That%20might%20lack%20the%20flexibility%2C%20but%20it%20is%20rare%20that%0A--%20I%20need%20to%20change%20the%20activation%20level%20or%20type%20of%20reset.%20For%20example%2C%20for%0A--%20FPGA%20circuits%2C%20asynchronous%20reset%20tend%20to%20use%20less%20resources%2C%20which%20makes%0A--%20it%20my%20default%20reset%20type.%0A%0Aentity%20reg_flexible%20is%0A%20%20%20%20generic(%0A%20%20%20%20%20%20%20%20WIDTH%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20positive%3B%0A%20%20%20%20%20%20%20%20HAS_ASYNC_RESET%20%20%20%20%20%20%20%20%3A%20boolean%20%20%20%20%20%20%20%20%20%20%3A%3D%20true%3B%0A%20%20%20%20%20%20%20%20RESET_ACTIVATION_LEVEL%20%3A%20std_logic%20%20%20%20%20%20%20%20%3A%3D%20&#39;1&#39;%3B%0A%0A%20%20%20%20%20%20%20%20--%20Here%20we%20use%20an%20unconstrained%20vector%20to%20work%20around%20an%20annoying%0A%20%20%20%20%20%20%20%20--%20limitation%20of%20VHDL%20(pre-2008).%20Ideally%2C%20we%20would%20just%20do%20something%0A%20%20%20%20%20%20%20%20--%20like%20this%3A%0A%20%20%20%20%20%20%20%20--%0A%20%20%20%20%20%20%20%20--%20RESET_VALUE%20%3A%20std_logic_vector(WIDTH-1%20downto%200)%20%3A%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20--%0A%20%20%20%20%20%20%20%20--%20However%2C%20the%201993%20version%20of%20VHDL%20does%20not%20allow%20use%20of%20generics%0A%20%20%20%20%20%20%20%20--%20to%20define%20other%20generics.%20Similarly%2C%20we%20can&#39;t%20do%3A%0A%20%20%20%20%20%20%20%20--%0A%20%20%20%20%20%20%20%20--%20RESET_VALUE%20%3A%20std_logic_vector%20%3A%3D%20(WIDTH-1%20downto%200%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20--%0A%20%20%20%20%20%20%20%20--%20Using%20an%20unconstrained%20vector%20is%20a%20workaround%20because%20it%20will%20get%0A%20%20%20%20%20%20%20%20--%20its%20width%20from%20whatever%20value%20we%20pass%20in%20the%20generic%20map.%0A%20%20%20%20%20%20%20%20--%0A%20%20%20%20%20%20%20%20--%20We%20use%20default%20value%20of%20an%20empty%20vector%20so%20that%20the%20user%20does%20not%0A%20%20%20%20%20%20%20%20--%20have%20to%20specify%20a%20reset%20value%2C%20since%2099%25%20of%20the%20time%2C%20it%20will%20just%0A%20%20%20%20%20%20%20%20--%20be%20all%200s.%20Below%2C%20you%20will%20see%20how%20we%20simply%20check%20for%20the%20empty%0A%20%20%20%20%20%20%20%20--%20vector%2C%20and%20then%20use%20all%200s.%0A%0A%20%20%20%20%20%20%20%20RESET_VALUE%20%20%20%20%20%20%20%20%20%20%20%20%3A%20std_logic_vector%20%3A%3D%20%22%22%0A%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20port(%0A%20%20%20%20%20%20%20%20clk%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20rst%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20en%20%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20input%20%20%3A%20in%20%20std_logic_vector(WIDTH-1%20downto%200)%3B%0A%20%20%20%20%20%20%20%20output%20%3A%20out%20std_logic_vector(WIDTH-1%20downto%200)%0A%20%20%20%20%20%20%20%20)%3B%0Aend%20reg_flexible%3B%0A%0A%0A--%20In%20the%20first%20architecture%20for%20the%20flexible%20register%2C%20we%20use%20if%20generates%0A--%20to%20handle%20the%20two%20reset%20types.%0Aarchitecture%20BHV1%20of%20reg_flexible%20is%0Abegin%0A%20%20%20%20%0A%20%20%20%20ASYNC_RESET%20%3A%20if%20HAS_ASYNC_RESET%20generate%20%20%20%20%20%0A%20%20%20%20%20%20%20%20process(clk%2C%20rst)%0A%20%20%20%20%20%20%20%20begin%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20Here%20I%20check%20the%20reset%20level%20generic%20instead%20of%20a%20hardcoded%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20literal.%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(rst%20%3D%20RESET_ACTIVATION_LEVEL)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20Because%20I%20assigned%20an%20empty%20vector%20as%20a%20default%20value%20for%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20the%20reset%20value%2C%20I%20can%20check%20if%20it%20is%20empty%20to%20see%20whether%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20or%20not%20to%20use%20a%20user-specified%20value%2C%20or%20the%20more%20common%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20value.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20Note%20that%20ideally%20I%20would%20have%20just%20made%20the%20default%20value%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20WIDTH%20&#39;0&#39;s%2C%20but%20there%20is%20no%20way%20to%20do%20this%20in%20VHDL%20pre-2008%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20because%20you%20can&#39;t%20use%20a%20generic%20value%20(e.g.%20WIDTH)%20to%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20define%20defalut%20values%20for%20other%20generics.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20Using%20the%20empty%20vector%20as%20a%20default%20is%20a%20little%20ugly%2C%20but%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20--%20provides%20a%20workaround.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(RESET_VALUE%20%2F%3D%20%22%22)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20RESET_VALUE%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20elsif%20(rising_edge(clk))%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(en%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20input%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20end%20process%3B%0A%20%20%20%20end%20generate%20ASYNC_RESET%3B%0A%20%20%20%20%0A%20%20%20%20SYNC_RESET%20%3A%20if%20not%20HAS_ASYNC_RESET%20generate%0A%20%20%20%20%20%20%20%20process(clk)%0A%20%20%20%20%20%20%20%20begin%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(rising_edge(clk))%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(rst%20%3D%20RESET_ACTIVATION_LEVEL)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(RESET_VALUE%20%2F%3D%20%22%22)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20RESET_VALUE%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elsif%20(en%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20input%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20end%20process%3B%0A%20%20%20%20end%20generate%3B%0Aend%20BHV1%3B%0A%0A%0A%0A--%20In%20the%20second%20architecture%20we%20use%20a%20single%20process%20to%20describe%20both%0A--%20reset%20types.%0A%0Aarchitecture%20BHV2%20of%20reg_flexible%20is%0Abegin%0A%20%20%20%20--%20We%20include%20clock%20and%20reset%20since%20we%20have%20to%20support%20the%20asynchronous%0A%20%20%20%20--%20reset.%20This%20isn&#39;t%20ideal%20for%20the%20synchronous%20reset%2C%20but%20will%20still%0A%20%20%20%20--%20function%20correctly%20in%20simulation%20and%20synthesis.%0A%20%20%20%20process(clk%2C%20rst)%0A%20%20%20%20begin%0A%20%20%20%20%20%20%20%20--%20First%20we%20check%20to%20see%20if%20the%20register%20has%20an%20async%20reset.%20This%20might%0A%20%20%20%20%20%20%20%20--%20seem%20like%20a%20violation%20of%20my%20coding%20guidelines%2C%20but%20it%20isn&#39;t%20because%0A%20%20%20%20%20%20%20%20--%20HAS_ASYNC_RESET%20is%20essentially%20a%20constant.%20If%20it%20is%20&#39;1&#39;%2C%20this%20is%0A%20%20%20%20%20%20%20%20--%20equivalent%20to%20%22if%20(rst)%22.%20If%20it%20is%20&#39;0&#39;%2C%20the%20synthesis%20tool%20will%0A%20%20%20%20%20%20%20%20--%20perform%20dead-code%20elimination%20and%20get%20rid%20of%20the%20if%20completely.%0A%20%20%20%20%20%20%20%20if%20(HAS_ASYNC_RESET%20and%20rst%20%3D%20RESET_ACTIVATION_LEVEL)%20then%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(RESET_VALUE%20%2F%3D%20%22%22)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20RESET_VALUE%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20elsif%20(rising_edge(clk))%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(not%20HAS_ASYNC_RESET%20and%20rst%20%3D%20RESET_ACTIVATION_LEVEL)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(RESET_VALUE%20%2F%3D%20%22%22)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20RESET_VALUE%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20elsif%20(en%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3C%3D%20input%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20end%20process%3B%0Aend%20BHV2%3B%0A%0A%0Alibrary%20ieee%3B%0Ause%20ieee.std_logic_1164.all%3B%0A%0A--%20Entity%3A%20reg%0A--%20Description%3A%20Provides%20a%20top-level%20reigster%20entity%20for%20evaluating%20all%20the%0A--%20implementations%20shown%20above.%0A%0Aentity%20reg%20is%0A%20%20%20%20generic(%0A%20%20%20%20%20%20%20%20WIDTH%20%3A%20positive%20%3A%3D%208%0A%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20port(%0A%20%20%20%20%20%20%20%20clk%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20rst%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20en%20%20%20%20%20%3A%20in%20%20std_logic%3B%0A%20%20%20%20%20%20%20%20input%20%20%3A%20in%20%20std_logic_vector(WIDTH-1%20downto%200)%3B%0A%20%20%20%20%20%20%20%20output%20%3A%20out%20std_logic_vector(WIDTH-1%20downto%200)%0A%20%20%20%20%20%20%20%20)%3B%0Aend%20reg%3B%0A%0Aarchitecture%20default_arch%20of%20reg%20is%0Abegin%0A%0A%20%20%20%20--%20INSTRUCTIONS%3A%20Uncomment%20the%20architecture%2Fentity%20that%20you%20want%20to%0A%20%20%20%20--%20evaluate.%0A%0A%20%20%20%20U_REG%20%3A%20entity%20work.reg_en_async_rst%0A%20%20%20%20--U_REG%20%3A%20entity%20work.reg_en_sync_rst(BHV)%0A%20%20%20%20--U_REG%20%3A%20entity%20work.reg_en_sync_rst(BAD)%0A%20%20%20%20%20%20%20%20generic%20map%20(WIDTH%20%3D%3E%20WIDTH)%0A%20%20%20%20%20%20%20%20port%20map%20(clk%20%20%20%20%3D%3E%20clk%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rst%20%20%20%20%3D%3E%20rst%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20en%20%20%20%20%20%3D%3E%20en%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20input%20%20%3D%3E%20input%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3D%3E%20output)%3B%0A%0A%20%20%20%20--%20Feel%20free%20to%20test%20these%2C%20but%20note%20that%20the%20testbench%20assumes%20an%0A%20%20%20%20--%20active%20high%20reset%2C%20so%20some%20parameter%20combinations%20might%20have%20failed%0A%20%20%20%20--%20assertions.%0A%0A%20%20%20%20--U_REG%20%3A%20entity%20work.reg_flexible(BHV1)%0A%20%20%20%20--%20%20%20%20--U_REG%20%3A%20entity%20work.reg_flexible(BHV2)%20%20%0A%20%20%20%20--%20%20%20%20generic%20map%20(%0A%20%20%20%20--%20%20%20%20%20%20%20%20WIDTH%20%3D%3E%20WIDTH%2C%0A%20%20%20%20--%20%20%20%20%20%20%20%20HAS_ASYNC_RESET%20%3D%3E%20true%2C%0A%20%20%20%20--%20%20%20%20%20%20%20%20RESET_ACTIVATION_LEVEL%20%3D%3E%20&#39;1&#39;%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20--%20%20%20%20%20%20%20%20--%20This%20is%20a%20convenient%20way%20of%20specifying%20all%200s%20for%20a%20known%20range.%0A%20%20%20%20--%20%20%20%20%20%20%20%20--%20The%20usual%20(others%20%3D%3E%20&#39;0&#39;)%20will%20not%20work%20here%20because%20RESET_VALUE%0A%20%20%20%20--%20%20%20%20%20%20%20%20--%20is%20unconstrained.%0A%20%20%20%20--%20%20%20%20%20%20%20%20RESET_VALUE%20%3D%3E%20(WIDTH-1%20downto%200%20%3D%3E%20&#39;0&#39;)%0A%20%20%20%20--%20%20%20%20%20%20%20%20)%0A%20%20%20%20--%20%20%20%20port%20map%20(clk%20%20%20%20%3D%3E%20clk%2C%0A%20%20%20%20--%20%20%20%20%20%20%20%20%20%20%20%20%20%20rst%20%20%20%20%3D%3E%20rst%2C%0A%20%20%20%20--%20%20%20%20%20%20%20%20%20%20%20%20%20%20en%20%20%20%20%20%3D%3E%20en%2C%0A%20%20%20%20--%20%20%20%20%20%20%20%20%20%20%20%20%20%20input%20%20%3D%3E%20input%2C%0A%20%20%20%20--%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%3D%3E%20output)%3B%0A%0A%20%20%20%20%0Aend%20default_arch%3B%0A" style="text-decoration:none !important;" download="reg.vhd"><code style="border:1px solid var(--vp-c-brand-darker);color:var(--vp-c-brand-darker);padding:0.4em 0.8em;margin:0 0.8em 0.4em 0;">reg.vhd</code></a><a href="data:text/plain;charset=utf-8,--%20Greg%20Stitt%0A--%20University%20of%20Florida%0A%0A--%20Basic%20testbench%20for%20reg%20entity%20in%20reg.vhd.%20Demonstrates%20use%20of%20random%0A--%20numbers.%20This%20is%20an%20example%20of%20where%20a%20SystemVerilog%20testbench%20is%20much%0A--%20easier%20to%20create.%20See%20the%20implication%20operator%20in%20SystemVerilog%2C%20or%20look%0A--%20at%20the%20same%20register%20example%20in%20my%20SystemVerilog%20tutorial.%0A%0Alibrary%20ieee%3B%0Ause%20ieee.std_logic_1164.all%3B%0Ause%20ieee.numeric_std.all%3B%0Ause%20ieee.math_real.all%3B%0A%0Aentity%20reg_tb%20is%0Aend%20reg_tb%3B%0A%0Aarchitecture%20random_tb%20of%20reg_tb%20is%0A%0A%20%20%20%20constant%20NUM_TESTS%20%3A%20integer%20%3A%3D%2010000%3B%0A%20%20%20%20constant%20WIDTH%20%20%3A%20positive%20%3A%3D%208%3B%0A%0A%20%20%20%20signal%20clk_en%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20std_logic%20%3A%3D%20&#39;1&#39;%3B%0A%20%20%20%20signal%20clk%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20std_logic%20%3A%3D%20&#39;0&#39;%3B%0A%20%20%20%20signal%20rst%2C%20en%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20std_logic%3B%0A%20%20%20%20signal%20input%2C%20output%2C%20output_correct%20%3A%20std_logic_vector(WIDTH-1%20downto%200)%3B%0A%20%20%20%20%0Abegin%0A%20%20%20%20%0A%20%20%20%20DUT%20%3A%20entity%20work.reg%0A%20%20%20%20%20%20%20%20generic%20map%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20WIDTH%20%20%3D%3E%20WIDTH)%0A%20%20%20%20%20%20%20%20port%20map%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20clk%20%20%20%20%3D%3E%20clk%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20rst%20%20%20%20%3D%3E%20rst%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20en%20%20%20%20%20%3D%3E%20en%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20input%20%20%3D%3E%20input%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20output%20%3D%3E%20output%0A%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%0A%20%20%20%20--%20Generate%20a%20100%20MHz%20clock.%20We%20gate%20the%20clock%20because%20the%20simulation%0A%20%20%20%20--%20will%20continue%20to%20run%20as%20long%20as%20there%20are%20events%20to%20simulate.%20Without%0A%20%20%20%20--%20the%20gate%2C%20this%20concurrent%20statement%20will%20run%20forever.%20With%20the%20gate%2C%0A%20%20%20%20--%20we%20can%20disable%20clk_en%2C%20and%20the%20clock%20will%20stop%2C%20causing%20the%20simulation%0A%20%20%20%20--%20to%20end.%0A%20%20%20%20clk%20%3C%3D%20not%20clk%20and%20clk_en%20after%205%20ns%3B%0A%0A%20%20%20%20process%0A%20%20%20%20%20%20%20%20variable%20seed1%2C%20seed2%20%3A%20positive%20%3A%3D%201%3B%0A%20%20%20%20%20%20%20%20variable%20rand_val%20%20%20%20%20%3A%20real%3B%0A%20%20%20%20begin%0A%20%20%20%20%20%20%20%20--%20Reset%20the%20register%0A%20%20%20%20%20%20%20%20rst%20%20%20%3C%3D%20&#39;1&#39;%3B%0A%20%20%20%20%20%20%20%20en%20%20%20%20%3C%3D%20&#39;0&#39;%3B%0A%20%20%20%20%20%20%20%20input%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%0A%0A%20%20%20%20%20%20%20%20--%20Wait%20for%204%20clock%20cycles.%0A%20%20%20%20%20%20%20%20for%20i%20in%200%20to%203%20loop%0A%20%20%20%20%20%20%20%20%20%20%20%20wait%20until%20rising_edge(clk)%3B%0A%20%20%20%20%20%20%20%20end%20loop%3B%0A%0A%20%20%20%20%20%20%20%20--%20Clear%20the%20register%20for%20one%20cycle.%0A%20%20%20%20%20%20%20%20rst%20%3C%3D%20&#39;0&#39;%3B%0A%20%20%20%20%20%20%20%20wait%20until%20rising_edge(clk)%3B%0A%0A%20%20%20%20%20%20%20%20--%20Perform%20NUM_TESTS%20random%20tests%20of%20both%20the%20input%20and%20enable%2C%20with%0A%20%20%20%20%20%20%20%20--%20the%20enable%20being%20asserted%20with%2075%25%20probability.%0A%20%20%20%20%20%20%20%20for%20i%20in%200%20to%20NUM_TESTS-1%20loop%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20Generating%20random%20numbers%20in%20VHDL%20is%20pretty%20awkward.%20We%20have%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20to%20call%20uniform%20to%20get%20a%20random%20real%20between%200%20and%201%2C%20and%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20manipulate%20it%20however%20we%20want.%0A%20%20%20%20%20%20%20%20%20%20%20%20uniform(seed1%2C%20seed2%2C%20rand_val)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20Generates%20a%20ranodom%20input.%0A%20%20%20%20%20%20%20%20%20%20%20%20input%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%3D%20std_logic_vector(to_unsigned(integer(floor(rand_val%20*%20real(2**WIDTH-1)))%2C%20WIDTH))%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20--%20Generate%20a%20random%20enable%20with%2075%25%20probability.%0A%20%20%20%20%20%20%20%20%20%20%20%20uniform(seed1%2C%20seed2%2C%20rand_val)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(rand_val%20%3E%200.75)%20then%20en%20%3C%3D%20&#39;1&#39;%3B%20else%20en%20%3C%3D%20&#39;0&#39;%3B%20end%20if%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20wait%20until%20rising_edge(clk)%3B%0A%20%20%20%20%20%20%20%20end%20loop%3B%0A%0A%20%20%20%20%20%20%20%20--%20Disable%20the%20clock%20to%20terminate%20the%20simulation.%0A%20%20%20%20%20%20%20%20clk_en%20%3C%3D%20&#39;0&#39;%3B%0A%20%20%20%20%20%20%20%20report%20%22Tests%20completed.%22%3B%0A%20%20%20%20%20%20%20%20wait%3B%0A%20%20%20%20end%20process%3B%0A%0A%20%20%20%20--%20The%20output%20of%20the%20register%20should%20match%20the%20reference%20model%20every%20cycle%0A%20%20%20%20--%20that%20the%20register%20isn&#39;t%20being%20reset.%0A%20%20%20%20assert(not%20(rising_edge(clk)%20and%20rst%20%3D%20&#39;0&#39;%20and%20output%20%2F%3D%20output_correct))%3B%0A%0A%20%20%20%20--------------------------------------------------------------------%0A%20%20%20%20--%20Reference%20model%0A%20%20%20%20--%0A%20%20%20%20--%20A%20testbench%20for%20just%20a%20register%20isn&#39;t%20a%20great%20example%20because%20unless%0A%20%20%20%20--%20you%20have%20an%20existing%20register%20entity%20to%20act%20as%20a%20reference%20model%2C%20you%0A%20%20%20%20--%20basically%20have%20to%20use%20the%20same%20sequential%20code.%20%20%20%0A%20%20%20%20process(clk%2C%20rst)%0A%20%20%20%20begin%0A%20%20%20%20%20%20%20%20if%20(rst%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20output_correct%20%3C%3D%20(others%20%3D%3E%20&#39;0&#39;)%3B%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20elsif%20(rising_edge(clk))%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(en%20%3D%20&#39;1&#39;)%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output_correct%20%3C%3D%20input%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20%20%20%20%20end%20if%3B%0A%20%20%20%20end%20process%3B%0A%0A%20%20%20%20--%20SYSTEM%20VERILOG%20COMPARISON%3A%20This%20is%20the%20first%20example%20where%20SystemVerilog%0A%20%20%20%20--%20has%20huge%20advantages%20over%20VHDL%20testbenches.%20SystemVerilog%20has%20sequences%0A%20%20%20%20--%20and%20an%20implication%20operator%20that%20allow%20you%20to%20evaluate%20boolean%0A%20%20%20%20--%20expressions%20over%20a%20range%20of%20time.%20Ultimately%2C%20for%20a%20register%2C%20we%20want%0A%20%20%20%20--%20to%20ensure%20that%20when%20it%20is%20enabled%20and%20not%20reset%2C%20then%20one%20cycle%20later%0A%20%20%20%20--%20the%20output%20is%20equal%20to%20the%20previous%20input.%20SystemVerilog%20has%20a%20very%0A%20%20%20%20--%20elegant%20way%20of%20specifying%20this%20requirement%3A%0A%20%20%20%20--%0A%20%20%20%20--%20assert%20property(%40(posedge%20clk)%20disable%20iff%20(rst)%20en%20%7C%3D%3E%20out%20%3D%3D%20%24past(in%2C1))%3B%0A%20%20%20%20--%0A%20%20%20%20--%20Similarly%2C%20we%20should%20also%20check%20to%20make%20sure%20that%20the%20output%20doesn&#39;t%0A%20%20%20%20--%20change%20when%20the%20register%20is%20not%20enabled.%20In%20other%20words%2C%20we%20want%20to%0A%20%20%20%20--%20verify%20that%20when%20en%20is%20&#39;0&#39;%20and%20rst%20%3D%20&#39;0&#39;%2C%20then%20one%20cycle%20later%2C%20the%0A%20%20%20%20--%20output%20hasn&#39;t%20changed.%20Again%2C%20SystemVerilog%20makes%20this%20very%20simple%3A%0A%20%20%20%20--%0A%20%20%20%20--%20assert%20property(%40(posedge%20clk)%20disable%20iff%20(rst)%20!en%20%7C%3D%3E%20%24stable(out))%3B%0A%20%20%20%20--%0A%20%20%20%20--%20Ideally%2C%20we%20would%20verify%20the%20reset%20functionality%20so%20that%20one%20cycle%20after%0A%20%20%20%20--%20a%20reset%2C%20the%20output%20should%20be%200%3A%0A%20%20%20%20--%0A%20%20%20%20--%20assert%20property(%40(posedge%20clk)%20rst%20%7C%3D%3E%20out%20%3D%3D%20&#39;0)%3B%0A%20%20%20%20--%0A%20%20%20%20--%20Even%20better%2C%20we%20can%20have%20a%20test%20specifically%20for%20an%20async%20reset%20where%0A%20%20%20%20--%20we%20want%20to%20make%20sure%20the%20output%20is%20cleared%20within%201%20ns%20of%20reset%20being%0A%20%20%20%20--%20asserted%3A%0A%20%20%20%20--%0A%20%20%20%20--%20always%20%40(rst)%20%231%20assert(out%20%3D%3D%20&#39;0)%3B%0A%20%20%20%20--%0A%20%20%20%20--%20To%20my%20knowledge%2C%20there%20is%20no%20easy%20way%20of%20accomplishing%20this%20same%0A%20%20%20%20--%20functionality%20in%20VHDL.%20The%20good%20news%20is%20that%20you%20can%20use%20a%20SV%20testbench%0A%20%20%20%20--%20for%20VHDL%20code%2C%20which%20will%20be%20demonstrated%20later.%0A%20%20%20%20%0Aend%20random_tb%3B%0A" style="text-decoration:none !important;" download="reg_tb.vhd"><code style="border:1px solid var(--vp-c-brand-darker);color:var(--vp-c-brand-darker);padding:0.4em 0.8em;margin:0 0.8em 0.4em 0;">reg_tb.vhd</code></a></div><div style="font-size:0.8em;font-weight:bold;margin-top:1em;"> If your browser displays the code as plain text, press <code style="font-size:inherit;">Ctrl/Cmd</code> + <code style="font-size:inherit;">S</code> to save it. </div></details><h2 id="brief" tabindex="-1">Brief <a class="header-anchor" href="#brief" aria-hidden="true">#</a></h2><ul><li>Illustrates how to create an asynchronous reset, a synchronous reset, an enable/load, and a highly parameterized register with different reset types and activiation levels.</li></ul><h2 id="entity-reg-async-rst" tabindex="-1">Entity <code>reg_async_rst</code> <a class="header-anchor" href="#entity-reg-async-rst" aria-hidden="true">#</a></h2><p>This example illustrates a variety of different register entities. To simulate/synthesize a different entity, change the comments in the reg entity at the bottom of this file.</p><p>A full discussion of the tradeoffs of different reset types is outside the scope of this example, but generally for FPGA designs I use asynchronous resets because they are supported by the flip flops in every FPGA I use. Synchronous resets still work, but require a mux in front of the flip flop That mux takes away one input from the LUT in front of the flip flop, which can cause significant increases in resource usage.</p><p>Also, as a general rule, I avoid resetting registers unless required. For beginners I highly recommend resetting all registers, but once you are comfortable with seeing &#39;U&#39; values in a simulation, you can significantly optimize a design by only resetting what is necessary. The reason for this optimization is that reset signals have a huge fan-out, which makes it challenging for placement and routing to create a good solution.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">library</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">use</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">std_logic_1164</span><span style="color:#89DDFF;">.all;</span></span>
<span class="line"></span></code></pre></div><p>Entity: reg_async_rst Description: Implements a register with an active high, asynchronous reset.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_async_rst</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">generic(</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">positive</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">port(</span></span>
<span class="line"><span style="color:#A6ACCD;">        clk    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        rst    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">out</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_async_rst</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="arch-bhv-of-reg-async-rst" tabindex="-1">Arch <code>BHV</code> of <a href="#entity-reg-async-rst"><code>reg_async_rst</code></a> <a class="header-anchor" href="#arch-bhv-of-reg-async-rst" aria-hidden="true">#</a></h3><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">architecture</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_async_rst</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- GUIDELINE 1 FOR SEQUENTIAL LOGIC: The sensitivity list should</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- only have clock and reset (if there is an asynchronous reset). It</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- technically shouldn&#39;t hurt anything if you include other signals, but</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- they are not necessary, can slow down a simulation by needlessly</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- retriggering the process, and might confuse a bad synthesis tool.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">process(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- SYNTHESIS GUIDELINE 2 FOR SEQUENTIAL LOGIC: All sequential logic with</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- async reset should be described using the following basic structure:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- if reset</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">--   handle reset </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- elsif rising clock edge</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">--   specify all non-reset functionality</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- end if</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- Do not try to come up with another way of specifying equivalent</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- behavior. Synthesis tools often require this template.</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- There are other techniques that will work with some tools, but since</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- this template works for any form of sequential logic, there is no</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- need to change it.</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- Reset the output to all 0s. The others statement sets all the</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- bits equal to the specified value. It is part of a more general</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- aggregation construct that will be discussed in other examples.</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">elsif</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- SYNTHESIS RULE: Any assignment to a signal on a rising clock</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- edge will be synthesized as a register, where the LHS is the</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- output of the register, and the RHS is the input. This might</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- seem obvious for this simple example, but it is critically</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- important to remember this rule for bigger examples because</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- adding or omitting a register is a very common source of bugs.</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- When we &quot;design the circuit&quot; before writing the code, a huge</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- part of that design is determining the number of registers.</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- To ensure that the synthesized circuit has the same number of</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- registers as our design circuit, we need to understand how</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- registers get created during synthesis.</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- Note that variables can be synthesized as either wires or</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- registers depending on the usage, which will be explained in</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- later examples.</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="entity-reg-sync-rst" tabindex="-1">Entity <code>reg_sync_rst</code> <a class="header-anchor" href="#entity-reg-sync-rst" aria-hidden="true">#</a></h2><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">library</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">use</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">std_logic_1164</span><span style="color:#89DDFF;">.all;</span></span>
<span class="line"></span></code></pre></div><p>Entity: reg_sync_rst Description: Implements a register with an active high, synchronous reset.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_sync_rst</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">generic(</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">positive</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">port(</span></span>
<span class="line"><span style="color:#A6ACCD;">        clk    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        rst    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">out</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_sync_rst</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="arch-bhv-of-reg-sync-rst" tabindex="-1">Arch <code>BHV</code> of <a href="#entity-reg-sync-rst"><code>reg_sync_rst</code></a> <a class="header-anchor" href="#arch-bhv-of-reg-sync-rst" aria-hidden="true">#</a></h3><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">architecture</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_sync_rst</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- For a synchronous reset, we only need the clock in the sensitivity list.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- However, it doesn&#39;t really hurt to include reset because a simulation is</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- unlikely to be frequently resetting a register, so it probably won&#39;t</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- slow down the simulation much. Also, it won&#39;t affect synthesis. </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">process(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- For the synchronous reset, we check the reset on the rising</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- clock edge.</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="entity-reg-en-async-rst" tabindex="-1">Entity <code>reg_en_async_rst</code> <a class="header-anchor" href="#entity-reg-en-async-rst" aria-hidden="true">#</a></h2><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">library</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">use</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">std_logic_1164</span><span style="color:#89DDFF;">.all;</span></span>
<span class="line"></span></code></pre></div><p>Entity: reg_en_async_rst Description: Implements a register with an enable, and an active high, asynchronous reset. The register holds its value when enable isn&#39;t asserted.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_en_async_rst</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">generic(</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">positive</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">port(</span></span>
<span class="line"><span style="color:#A6ACCD;">        clk    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        rst    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        en     </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">out</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_en_async_rst</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="arch-bhv-of-reg-en-async-rst" tabindex="-1">Arch <code>BHV</code> of <a href="#entity-reg-en-async-rst"><code>reg_en_async_rst</code></a> <a class="header-anchor" href="#arch-bhv-of-reg-en-async-rst" aria-hidden="true">#</a></h3><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">architecture</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_en_async_rst</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">process(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">elsif</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- Here we simply add an if statement to check if enable is</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- asserted. Note that to comply with my coding guideline,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- this has to be done on the rising clock edge since it isn&#39;t</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- related to reset.</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">en </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="entity-reg-en-sync-rst" tabindex="-1">Entity <code>reg_en_sync_rst</code> <a class="header-anchor" href="#entity-reg-en-sync-rst" aria-hidden="true">#</a></h2><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">library</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">use</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">std_logic_1164</span><span style="color:#89DDFF;">.all;</span></span>
<span class="line"></span></code></pre></div><p>Entity: reg_en_sync_rst Description: Implements a register with an enable, and an active high, synchronous reset. The register holds its value when enable isn&#39;t asserted.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_en_sync_rst</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">generic(</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">positive</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">port(</span></span>
<span class="line"><span style="color:#A6ACCD;">        clk    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        rst    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        en     </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">out</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_en_sync_rst</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="arch-bhv-of-reg-en-sync-rst" tabindex="-1">Arch <code>BHV</code> of <a href="#entity-reg-en-sync-rst"><code>reg_en_sync_rst</code></a> <a class="header-anchor" href="#arch-bhv-of-reg-en-sync-rst" aria-hidden="true">#</a></h3><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">architecture</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_en_sync_rst</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">process(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- Here we move the reset on the clock edge to make it synchronous</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- and then have an elsif for the enable. Note that we have to</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- check the conditions in this order since reset has priority</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- over the enable.</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">elsif</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">en </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="arch-bad-of-reg-en-sync-rst" tabindex="-1">Arch <code>BAD</code> of <a href="#entity-reg-en-sync-rst"><code>reg_en_sync_rst</code></a> <a class="header-anchor" href="#arch-bad-of-reg-en-sync-rst" aria-hidden="true">#</a></h3><p>The following architecture is an example of a violation of synthesis coding guidelines. It simulates perfectly, and is semantically correct in terms of behavior, but it is unlikely that a synthesis tool will recognize this as a register, at least without warnings.</p><p>I tested it in Quartus and it warned about en not being in the sensitivity list, which suggests it thinks it is combinational logic. The RTL viewer shows a register, so it might have worked, but is still a bad idea. I see student code all the time that works in simulation but does not synthesize correctly because of deviating from the specified template.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">architecture</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BAD</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_en_sync_rst</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">process(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">and</span><span style="color:#A6ACCD;"> rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span><span style="color:#A6ACCD;">            </span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">elsif</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">and</span><span style="color:#A6ACCD;"> en </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">            </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BAD</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="entity-reg-flexible" tabindex="-1">Entity <code>reg_flexible</code> <a class="header-anchor" href="#entity-reg-flexible" aria-hidden="true">#</a></h2><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">library</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">use</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">std_logic_1164</span><span style="color:#89DDFF;">.all;</span></span>
<span class="line"></span></code></pre></div><p>Entity: reg_en_sync_rst Description: Implements a highly parameterized register with configurable width, reset type, reset activation level, and reset value.</p><p>As tempting as it might be to use this entity everywhere due to its versatility, it quickly becomes problematic structurally instantiating a register everywhere you need one. I almost never do this unless I know I need the versatility, which is very rare.</p><p>Generally, since creating a register only requires a single assignment on a rising clock edge, I&#39;ll just add an assignment to existing code to create more registers. That might lack the flexibility, but it is rare that I need to change the activation level or type of reset. For example, for FPGA circuits, asynchronous reset tend to use less resources, which makes it my default reset type.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_flexible</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">generic(</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;">                  </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">positive</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        HAS_ASYNC_RESET        </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">boolean</span><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> true</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        RESET_ACTIVATION_LEVEL </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- Here we use an unconstrained vector to work around an annoying</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- limitation of VHDL (pre-2008). Ideally, we would just do something</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- like this:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- RESET_VALUE : std_logic_vector(WIDTH-1 downto 0) := (others =&gt; &#39;0&#39;);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- However, the 1993 version of VHDL does not allow use of generics</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- to define other generics. Similarly, we can&#39;t do:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- RESET_VALUE : std_logic_vector := (WIDTH-1 downto 0 =&gt; &#39;0&#39;);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- Using an unconstrained vector is a workaround because it will get</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- its width from whatever value we pass in the generic map.</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- We use default value of an empty vector so that the user does not</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- have to specify a reset value, since 99% of the time, it will just</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- be all 0s. Below, you will see how we simply check for the empty</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- vector, and then use all 0s.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        RESET_VALUE            </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">&quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">port(</span></span>
<span class="line"><span style="color:#A6ACCD;">        clk    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        rst    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        en     </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">out</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_flexible</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="arch-bhv1-of-reg-flexible" tabindex="-1">Arch <code>BHV1</code> of <a href="#entity-reg-flexible"><code>reg_flexible</code></a> <a class="header-anchor" href="#arch-bhv1-of-reg-flexible" aria-hidden="true">#</a></h3><p>In the first architecture for the flexible register, we use if generates to handle the two reset types.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">architecture</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_flexible</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ASYNC_RESET</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> HAS_ASYNC_RESET </span><span style="color:#89DDFF;">generate</span><span style="color:#A6ACCD;">     </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">process(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- Here I check the reset level generic instead of a hardcoded</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- literal.</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RESET_ACTIVATION_LEVEL</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- Because I assigned an empty vector as a default value for</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- the reset value, I can check if it is empty to see whether</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- or not to use a user-specified value, or the more common 0</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- value.</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- Note that ideally I would have just made the default value</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- WIDTH &#39;0&#39;s, but there is no way to do this in VHDL pre-2008</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- because you can&#39;t use a generic value (e.g. WIDTH) to</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- define defalut values for other generics.</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- Using the empty vector as a default is a little ugly, but</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#676E95;">-- provides a workaround.</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">RESET_VALUE </span><span style="color:#89DDFF;">/=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">&quot;&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> RESET_VALUE</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">elsif</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">en </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">generate</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">ASYNC_RESET</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">SYNC_RESET</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">not</span><span style="color:#A6ACCD;"> HAS_ASYNC_RESET </span><span style="color:#89DDFF;">generate</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">process(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RESET_ACTIVATION_LEVEL</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">RESET_VALUE </span><span style="color:#89DDFF;">/=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">&quot;&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> RESET_VALUE</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">elsif</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">en </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">generate;</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="arch-bhv2-of-reg-flexible" tabindex="-1">Arch <code>BHV2</code> of <a href="#entity-reg-flexible"><code>reg_flexible</code></a> <a class="header-anchor" href="#arch-bhv2-of-reg-flexible" aria-hidden="true">#</a></h3><p>In the second architecture we use a single process to describe both reset types.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">architecture</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_flexible</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- We include clock and reset since we have to support the asynchronous</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- reset. This isn&#39;t ideal for the synchronous reset, but will still</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- function correctly in simulation and synthesis.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">process(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- First we check to see if the register has an async reset. This might</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- seem like a violation of my coding guidelines, but it isn&#39;t because</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- HAS_ASYNC_RESET is essentially a constant. If it is &#39;1&#39;, this is</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- equivalent to &quot;if (rst)&quot;. If it is &#39;0&#39;, the synthesis tool will</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- perform dead-code elimination and get rid of the if completely.</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">HAS_ASYNC_RESET </span><span style="color:#89DDFF;">and</span><span style="color:#A6ACCD;"> rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RESET_ACTIVATION_LEVEL</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span><span style="color:#A6ACCD;">         </span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">RESET_VALUE </span><span style="color:#89DDFF;">/=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">&quot;&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> RESET_VALUE</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">elsif</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(not</span><span style="color:#A6ACCD;"> HAS_ASYNC_RESET </span><span style="color:#89DDFF;">and</span><span style="color:#A6ACCD;"> rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RESET_ACTIVATION_LEVEL</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">RESET_VALUE </span><span style="color:#89DDFF;">/=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">&quot;&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> RESET_VALUE</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">elsif</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">en </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BHV2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="entity-reg" tabindex="-1">Entity <code>reg</code> <a class="header-anchor" href="#entity-reg" aria-hidden="true">#</a></h2><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">library</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">use</span><span style="color:#A6ACCD;"> ieee</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">std_logic_1164</span><span style="color:#89DDFF;">.all;</span></span>
<span class="line"></span></code></pre></div><p>Entity: reg Description: Provides a top-level reigster entity for evaluating all the implementations shown above.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">generic(</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">positive</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">port(</span></span>
<span class="line"><span style="color:#A6ACCD;">        clk    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        rst    </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        en     </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">out</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="arch-default-arch-of-reg" tabindex="-1">Arch <code>default_arch</code> of <a href="#entity-reg"><code>reg</code></a> <a class="header-anchor" href="#arch-default-arch-of-reg" aria-hidden="true">#</a></h3><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">architecture</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">default_arch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#89DDFF;">begin</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- INSTRUCTIONS: Uncomment the architecture/entity that you want to</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- evaluate.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">U_REG</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">work</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">reg_en_async_rst</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--U_REG : entity work.reg_en_sync_rst(BHV)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--U_REG : entity work.reg_en_sync_rst(BAD)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">generic</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">map</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">port</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">map</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk    </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> clk</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                  rst    </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                  en     </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> en</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                  </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                  </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">output</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- Feel free to test these, but note that the testbench assumes an</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- active high reset, so some parameter combinations might have failed</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- assertions.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--U_REG : entity work.reg_flexible(BHV1)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--    --U_REG : entity work.reg_flexible(BHV2)  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--    generic map (</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--        WIDTH =&gt; WIDTH,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--        HAS_ASYNC_RESET =&gt; true,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--        RESET_ACTIVATION_LEVEL =&gt; &#39;1&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--        -- This is a convenient way of specifying all 0s for a known range.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--        -- The usual (others =&gt; &#39;0&#39;) will not work here because RESET_VALUE</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--        -- is unconstrained.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--        RESET_VALUE =&gt; (WIDTH-1 downto 0 =&gt; &#39;0&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--        )</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--    port map (clk    =&gt; clk,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--              rst    =&gt; rst,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--              en     =&gt; en,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--              input  =&gt; input,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--              output =&gt; output);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">default_arch</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="entity-reg-tb" tabindex="-1">Entity <code>reg_tb</code> <a class="header-anchor" href="#entity-reg-tb" aria-hidden="true">#</a></h2><p>Basic testbench for reg entity in reg.vhd. Demonstrates use of random numbers. This is an example of where a SystemVerilog testbench is much easier to create. See the implication operator in SystemVerilog, or look at the same register example in my SystemVerilog tutorial.</p><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_tb</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_tb</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="arch-random-tb-of-reg-tb" tabindex="-1">Arch <code>random_tb</code> of <a href="#entity-reg-tb"><code>reg_tb</code></a> <a class="header-anchor" href="#arch-random-tb-of-reg-tb" aria-hidden="true">#</a></h3><div class="language-vhdl"><button class="copy"></button><span class="lang">vhdl</span><pre><code><span class="line"><span style="color:#89DDFF;">architecture</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">random_tb</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">reg_tb</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">is</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">constant</span><span style="color:#A6ACCD;"> NUM_TESTS </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">integer</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">constant</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">positive</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">signal</span><span style="color:#A6ACCD;"> clk_en                        </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">signal</span><span style="color:#A6ACCD;"> clk                           </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">signal</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> en                       </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">signal</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">output</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> output_correct </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">downto</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">DUT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">entity</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">work</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">reg</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">generic</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">map</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">port</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">map</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">            clk    </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> clk</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            rst    </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            en     </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> en</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">output</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- Generate a 100 MHz clock. We gate the clock because the simulation</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- will continue to run as long as there are events to simulate. Without</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- the gate, this concurrent statement will run forever. With the gate,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- we can disable clk_en, and the clock will stop, causing the simulation</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- to end.</span></span>
<span class="line"><span style="color:#A6ACCD;">    clk </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">not</span><span style="color:#A6ACCD;"> clk </span><span style="color:#89DDFF;">and</span><span style="color:#A6ACCD;"> clk_en </span><span style="color:#89DDFF;">after</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ns</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">process</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">variable</span><span style="color:#A6ACCD;"> seed1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> seed2 </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">positive</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">variable</span><span style="color:#A6ACCD;"> rand_val     </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">real</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- Reset the register</span></span>
<span class="line"><span style="color:#A6ACCD;">        rst   </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        en    </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- Wait for 4 clock cycles.</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">wait</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">until</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- Clear the register for one cycle.</span></span>
<span class="line"><span style="color:#A6ACCD;">        rst </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">wait</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">until</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- Perform NUM_TESTS random tests of both the input and enable, with</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- the enable being asserted with 75% probability.</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">to</span><span style="color:#A6ACCD;"> NUM_TESTS</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- Generating random numbers in VHDL is pretty awkward. We have</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- to call uniform to get a random real between 0 and 1, and then</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- manipulate it however we want.</span></span>
<span class="line"><span style="color:#A6ACCD;">            uniform</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">seed1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> seed2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rand_val</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- Generates a ranodom input.</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">input</span><span style="color:#A6ACCD;">                        </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std_logic_vector</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">to_unsigned</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">integer</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">floor</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rand_val </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">real</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">**</span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">))),</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WIDTH</span><span style="color:#89DDFF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">-- Generate a random enable with 75% probability.</span></span>
<span class="line"><span style="color:#A6ACCD;">            uniform</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">seed1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> seed2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rand_val</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rand_val </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0.75</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span><span style="color:#A6ACCD;"> en </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">else</span><span style="color:#A6ACCD;"> en </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">wait</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">until</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">loop;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;">-- Disable the clock to terminate the simulation.</span></span>
<span class="line"><span style="color:#A6ACCD;">        clk_en </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">report</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">&quot;Tests completed.&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">wait;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- The output of the register should match the reference model every cycle</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- that the register isn&#39;t being reset.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">assert(not</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">and</span><span style="color:#A6ACCD;"> rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">and</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/=</span><span style="color:#A6ACCD;"> output_correct</span><span style="color:#89DDFF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- Reference model</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- A testbench for just a register isn&#39;t a great example because unless</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- you have an existing register entity to act as a reference model, you</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- basically have to use the same sequential code.   </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">process(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> rst</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rst </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            output_correct </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(others</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;0&#39;</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">elsif</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">rising_edge</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clk</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">en </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">&#39;1&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">                output_correct </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">process;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- SYSTEM VERILOG COMPARISON: This is the first example where SystemVerilog</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- has huge advantages over VHDL testbenches. SystemVerilog has sequences</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- and an implication operator that allow you to evaluate boolean</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- expressions over a range of time. Ultimately, for a register, we want</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- to ensure that when it is enabled and not reset, then one cycle later</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- the output is equal to the previous input. SystemVerilog has a very</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- elegant way of specifying this requirement:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- assert property(@(posedge clk) disable iff (rst) en |=&gt; out == $past(in,1));</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- Similarly, we should also check to make sure that the output doesn&#39;t</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- change when the register is not enabled. In other words, we want to</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- verify that when en is &#39;0&#39; and rst = &#39;0&#39;, then one cycle later, the</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- output hasn&#39;t changed. Again, SystemVerilog makes this very simple:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- assert property(@(posedge clk) disable iff (rst) !en |=&gt; $stable(out));</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- Ideally, we would verify the reset functionality so that one cycle after</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- a reset, the output should be 0:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- assert property(@(posedge clk) rst |=&gt; out == &#39;0);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- Even better, we can have a test specifically for an async reset where</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- we want to make sure the output is cleared within 1 ns of reset being</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- asserted:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- always @(rst) #1 assert(out == &#39;0);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">--</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- To my knowledge, there is no easy way of accomplishing this same</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- functionality in VHDL. The good news is that you can use a SV testbench</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">-- for VHDL code, which will be demonstrated later.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">random_tb</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-680f4f24 data-v-a71d3a6d><!----><div class="prev-next" data-v-a71d3a6d><div class="pager" data-v-a71d3a6d><a class="pager-link prev" href="/vhdl-tutorial/sequential/README.html" data-v-a71d3a6d><span class="desc" data-v-a71d3a6d>Previous page</span><span class="title" data-v-a71d3a6d>Introduction</span></a></div><div class="has-prev pager" data-v-a71d3a6d><a class="pager-link next" href="/vhdl-tutorial/sequential/seq_example.html" data-v-a71d3a6d><span class="desc" data-v-a71d3a6d>Next page</span><span class="title" data-v-a71d3a6d>Behavioral Code Syn. Examples</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-3ff9331b data-v-13fad65a><div class="container" data-v-13fad65a><p class="message" data-v-13fad65a>Released under GNU GENERAL PUBLIC LICENSE.</p><p class="copyright" data-v-13fad65a>Copyright  2022-present Greg Stitt</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"readme.md\":\"2c8563c5\",\"combinational_readme.md\":\"ecd21fc1\",\"combinational_add.md\":\"ea1acd5e\",\"combinational_alu.md\":\"d537c7e3\",\"combinational_mult.md\":\"3c7dcb1d\",\"combinational_mux_2x1.md\":\"ffda1f16\",\"combinational_priority_encoder.md\":\"84cb2209\",\"combinational_priority_encoder_4in.md\":\"1a616760\",\"fsm_readme.md\":\"895a3205\",\"fsm_mealy.md\":\"9fb44535\",\"fsm_moore.md\":\"97e511c6\",\"fsmd_readme.md\":\"c46cae1b\",\"fsmd_bit_diff.md\":\"d8112fe4\",\"index.md\":\"2747ebfb\",\"manual.md\":\"ed1b0a31\",\"sequential_readme.md\":\"ebc987f1\",\"sequential_counter.md\":\"04cf578b\",\"sequential_delay.md\":\"4b738da0\",\"sequential_reg.md\":\"6668b9bc\",\"sequential_seq_example.md\":\"a52498ab\",\"structural_readme.md\":\"55b1a763\",\"structural_delay.md\":\"70361a6a\",\"structural_mux4x1.md\":\"55c3c2a2\",\"structural_ripple_carry_adder.md\":\"2e176dda\"}")</script>
    <script type="module" async src="/vhdl-tutorial/assets/app.caac86f1.js"></script>
    
  </body>
</html>